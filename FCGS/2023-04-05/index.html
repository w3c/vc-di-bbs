<!DOCTYPE html><html lang="en" dir="ltr"><head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8">
<meta name="generator" content="ReSpec 33.0.1">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<style>
span.example-title{text-transform:none}
:is(aside,div).example,div.illegal-example{padding:.5em;margin:1em 0;position:relative;clear:both}
div.illegal-example{color:red}
div.illegal-example p{color:#000}
:is(aside,div).example{border-left-width:.5em;border-left-style:solid;border-color:#e0cb52;background:#fcfaee}
aside.example div.example{border-left-width:.1em;border-color:#999;background:#fff}
.example pre{background-color:rgba(0,0,0,.03)}
</style>
<style>
.issue-label{text-transform:initial}
.warning>p:first-child{margin-top:0}
.warning{padding:.5em;border-left-width:.5em;border-left-style:solid}
span.warning{padding:.1em .5em .15em}
.issue.closed span.issue-number{text-decoration:line-through}
.issue.closed span.issue-number::after{content:" (Closed)";font-size:smaller}
.warning{border-color:#f11;border-width:.2em;border-style:solid;background:#fbe9e9}
.warning-title:before{content:"⚠";font-size:1.3em;float:left;padding-right:.3em;margin-top:-.3em}
li.task-list-item{list-style:none}
input.task-list-item-checkbox{margin:0 .35em .25em -1.6em;vertical-align:middle}
.issue a.respec-gh-label{padding:5px;margin:0 2px 0 2px;font-size:10px;text-transform:none;text-decoration:none;font-weight:700;border-radius:4px;position:relative;bottom:2px;border:none;display:inline-block}
</style>
<style>
dfn{cursor:pointer}
.dfn-panel{position:absolute;z-index:35;min-width:300px;max-width:500px;padding:.5em .75em;margin-top:.6em;font-family:"Helvetica Neue",sans-serif;font-size:small;background:#fff;color:#000;box-shadow:0 1em 3em -.4em rgba(0,0,0,.3),0 0 1px 1px rgba(0,0,0,.05);border-radius:2px}
.dfn-panel:not(.docked)>.caret{position:absolute;top:-9px}
.dfn-panel:not(.docked)>.caret::after,.dfn-panel:not(.docked)>.caret::before{content:"";position:absolute;border:10px solid transparent;border-top:0;border-bottom:10px solid #fff;top:0}
.dfn-panel:not(.docked)>.caret::before{border-bottom:9px solid #a2a9b1}
.dfn-panel *{margin:0}
.dfn-panel b{display:block;color:#000;margin-top:.25em}
.dfn-panel ul a[href]{color:#333}
.dfn-panel>div{display:flex}
.dfn-panel a.self-link{font-weight:700;margin-right:auto}
.dfn-panel .marker{padding:.1em;margin-left:.5em;border-radius:.2em;text-align:center;white-space:nowrap;font-size:90%;color:#040b1c}
.dfn-panel .marker.dfn-exported{background:#d1edfd;box-shadow:0 0 0 .125em #1ca5f940}
.dfn-panel .marker.idl-block{background:#8ccbf2;box-shadow:0 0 0 .125em #0670b161}
.dfn-panel a:not(:hover){text-decoration:none!important;border-bottom:none!important}
.dfn-panel a[href]:hover{border-bottom-width:1px}
.dfn-panel ul{padding:0}
.dfn-panel li{margin-left:1em}
.dfn-panel.docked{position:fixed;left:.5em;top:unset;bottom:2em;margin:0 auto;max-width:calc(100vw - .75em * 2 - .5em - .2em * 2);max-height:30vh;overflow:auto}
</style>
    
<title>BBS Cryptosuite v2023</title>
    
    
    
<style id="respec-mainstyle">
@keyframes pop{
0%{transform:scale(1,1)}
25%{transform:scale(1.25,1.25);opacity:.75}
100%{transform:scale(1,1)}
}
:is(h1,h2,h3,h4,h5,h6,a) abbr{border:none}
dfn{font-weight:700}
a.internalDFN{color:inherit;border-bottom:1px solid #99c;text-decoration:none}
a.externalDFN{color:inherit;border-bottom:1px dotted #ccc;text-decoration:none}
a.bibref{text-decoration:none}
.respec-offending-element:target{animation:pop .25s ease-in-out 0s 1}
.respec-offending-element,a[href].respec-offending-element{text-decoration:red wavy underline}
@supports not (text-decoration:red wavy underline){
.respec-offending-element:not(pre){display:inline-block}
.respec-offending-element{background:url(data:image/gif;base64,R0lGODdhBAADAPEAANv///8AAP///wAAACwAAAAABAADAEACBZQjmIAFADs=) bottom repeat-x}
}
#references :target{background:#eaf3ff;animation:pop .4s ease-in-out 0s 1}
cite .bibref{font-style:normal}
a[href].orcid{padding-left:4px;padding-right:4px}
a[href].orcid>svg{margin-bottom:-2px}
.toc a,.tof a{text-decoration:none}
a .figno,a .secno{color:#000}
ol.tof,ul.tof{list-style:none outside none}
.caption{margin-top:.5em;font-style:italic}
table.simple{border-spacing:0;border-collapse:collapse;border-bottom:3px solid #005a9c}
.simple th{background:#005a9c;color:#fff;padding:3px 5px;text-align:left}
.simple th a{color:#fff;padding:3px 5px;text-align:left}
.simple th[scope=row]{background:inherit;color:inherit;border-top:1px solid #ddd}
.simple td{padding:3px 10px;border-top:1px solid #ddd}
.simple tr:nth-child(even){background:#f0f6ff}
.section dd>p:first-child{margin-top:0}
.section dd>p:last-child{margin-bottom:0}
.section dd{margin-bottom:1em}
.section dl.attrs dd,.section dl.eldef dd{margin-bottom:0}
#issue-summary>ul{column-count:2}
#issue-summary li{list-style:none;display:inline-block}
details.respec-tests-details{margin-left:1em;display:inline-block;vertical-align:top}
details.respec-tests-details>*{padding-right:2em}
details.respec-tests-details[open]{z-index:999999;position:absolute;border:thin solid #cad3e2;border-radius:.3em;background-color:#fff;padding-bottom:.5em}
details.respec-tests-details[open]>summary{border-bottom:thin solid #cad3e2;padding-left:1em;margin-bottom:1em;line-height:2em}
details.respec-tests-details>ul{width:100%;margin-top:-.3em}
details.respec-tests-details>li{padding-left:1em}
.self-link:hover{opacity:1;text-decoration:none;background-color:transparent}
aside.example .marker>a.self-link{color:inherit}
.header-wrapper{display:flex;align-items:baseline}
:is(h2,h3,h4,h5,h6):not(#toc>h2,#abstract>h2,#sotd>h2,.head>h2){position:relative;left:-.5em}
:is(h2,h3,h4,h5,h6):not(#toch2)+a.self-link{color:inherit;order:-1;position:relative;left:-1.1em;font-size:1rem;opacity:.5}
:is(h2,h3,h4,h5,h6)+a.self-link::before{content:"§";text-decoration:none;color:var(--heading-text)}
:is(h2,h3)+a.self-link{top:-.2em}
:is(h4,h5,h6)+a.self-link::before{color:#000}
@media (max-width:767px){
dd{margin-left:0}
}
@media print{
.removeOnSave{display:none}
}
</style>
    

    
        
<style>

          pre .highlight {
            font-weight: bold;
            color: green;
          }
          pre .comment {
            font-weight: bold;
            color: Gray;
          }
          .color-text {
            font-weight: bold;
            text-shadow: -1px 0 black, 0 1px black, 1px 0 black, 0 -1px black;
          }
          ol.algorithm {
            counter-reset: numsection;
            list-style-type: none;
          }
          ol.algorithm li {
            margin: 0.5em 0;
          }
          ol.algorithm li:before {
            font-weight: bold;
            counter-increment: numsection;
            content: counters(numsection, ".") ") ";
          }
              
</style>
  
<meta name="description" content="This specification describes the BBS+ Signature Suite created in 2020
for the Data Integrity specification. The Signature Suite utilizes
BBS+ signatures to provide the capability of zero knowledge
proof disclosures.">
<link rel="canonical" href="https://www.w3.org/community/reports/credentials/CG-FINAL-vc-di-bbs-20230405/">
<style>
.hljs{display:block;overflow-x:auto;padding:.5em;color:#383a42;background:#fafafa}
.hljs-comment,.hljs-quote{color:#717277;font-style:italic}
.hljs-doctag,.hljs-formula,.hljs-keyword{color:#a626a4}
.hljs-deletion,.hljs-name,.hljs-section,.hljs-selector-tag,.hljs-subst{color:#ca4706;font-weight:700}
.hljs-literal{color:#0b76c5}
.hljs-addition,.hljs-attribute,.hljs-meta-string,.hljs-regexp,.hljs-string{color:#42803c}
.hljs-built_in,.hljs-class .hljs-title{color:#9a6a01}
.hljs-attr,.hljs-number,.hljs-selector-attr,.hljs-selector-class,.hljs-selector-pseudo,.hljs-template-variable,.hljs-type,.hljs-variable{color:#986801}
.hljs-bullet,.hljs-link,.hljs-meta,.hljs-selector-id,.hljs-symbol,.hljs-title{color:#336ae3}
.hljs-emphasis{font-style:italic}
.hljs-strong{font-weight:700}
.hljs-link{text-decoration:underline}
</style>
<style>
var{position:relative;cursor:pointer}
var[data-type]::after,var[data-type]::before{position:absolute;left:50%;top:-6px;opacity:0;transition:opacity .4s;pointer-events:none}
var[data-type]::before{content:"";transform:translateX(-50%);border-width:4px 6px 0 6px;border-style:solid;border-color:transparent;border-top-color:#000}
var[data-type]::after{content:attr(data-type);transform:translateX(-50%) translateY(-100%);background:#000;text-align:center;font-family:"Dank Mono","Fira Code",monospace;font-style:normal;padding:6px;border-radius:3px;color:#daca88;text-indent:0;font-weight:400}
var[data-type]:hover::after,var[data-type]:hover::before{opacity:1}
</style>
<script id="initialUserConfig" type="application/json">{
  "specStatus": "CG-FINAL",
  "shortName": "vc-di-bbs",
  "subtitle": "Achieving Data Integrity using Unlinkable BBS Signatures",
  "group": "credentials",
  "latestVersion": "https://www.w3.org/community/reports/credentials/CG-FINAL-vc-di-bbs-20230405/",
  "edDraftURI": "https://w3c-ccg.github.io/vc-di-bbs/",
  "editors": [
    {
      "name": "Tobias Looker",
      "url": "https://mattr.global/",
      "company": "Mattr",
      "companyURL": "https://mattr.global/"
    },
    {
      "name": "Orie Steele",
      "url": "https://transmute.industries",
      "company": "Transmute",
      "companyURL": "https://transmute.industries"
    }
  ],
  "wg": "Credentials Community Group",
  "wgURI": "https://www.w3.org/community/credentials/",
  "wgPublicList": "public-credentials",
  "wgPatentURI": "https://www.w3.org/community/about/agreements/cla/",
  "otherLinks": [
    {
      "key": "Source control",
      "data": [
        {
          "value": "https://github.com/w3c-ccg/vc-di-bbs/",
          "href": "https://github.com/w3c-ccg/vc-di-bbs/"
        }
      ]
    },
    {
      "key": "Issue Tracker",
      "data": [
        {
          "value": "https://github.com/w3c-ccg/vc-di-bbs/issues/",
          "href": "https://github.com/w3c-ccg/vc-di-bbs/issues/"
        }
      ]
    }
  ],
  "maxTocLevel": 4,
  "localBiblio": {
    "RDF-DATASET-NORMALIZATION": {
      "title": "RDF Dataset Normalization 1.0",
      "href": "http://json-ld.github.io/normalization/spec/",
      "authors": [
        "David Longley",
        "Manu Sporny"
      ],
      "status": "CGDRAFT",
      "publisher": "JSON-LD Community Group",
      "id": "rdf-dataset-normalization"
    },
    "RDF-CONCEPTS": {
      "title": "RDF 1.1 Concepts and Abstract Syntax",
      "href": "https://www.w3.org/TR/rdf11-concepts/",
      "authors": [
        "Richard Cyganiak",
        "David Wood",
        "Markus Lanthaler"
      ],
      "status": "Recommendation",
      "publisher": "W3C",
      "id": "rdf-concepts"
    },
    "RDF-N-Quads": {
      "title": "RDF 1.1 N-Quads",
      "href": "http://json-ld.github.io/normalization/spec/",
      "authors": [
        "Gaven Carothers"
      ],
      "status": "Recommendation",
      "id": "rdf-n-quads"
    },
    "SECURITY-VOCABULARY": {
      "title": "Security Linked Data Vocabulary",
      "href": "https://web-payments.org/vocabs/security",
      "authors": [
        "Manu Sporny",
        "David Longley"
      ],
      "status": "CGDRAFT",
      "publisher": "Web Payments Community Group"
    },
    "DATA-INTEGRITY": {
      "title": "Data Integrity 1.0",
      "href": "https://w3c-ccg.github.io/data-integrity-spec/",
      "authors": [
        "David Longley",
        "Manu Sporny"
      ],
      "status": "CGDRAFT",
      "publisher": "Credentials Community Group",
      "id": "data-integrity"
    },
    "JSON-LD-FRAMING": {
      "title": "JSON-LD 1.1 Framing",
      "href": "https://www.w3.org/TR/json-ld11-framing",
      "authors": [
        "Dave Longley",
        "Gregg Kellogg",
        "Pierre-Antoine Champin"
      ],
      "status": "Candidate Recommendation",
      "publisher": "W3C",
      "id": "json-ld-framing"
    },
    "JSON-LD": {
      "title": "JSON-LD 1.1",
      "href": "https://www.w3.org/TR/json-ld11",
      "authors": [
        "Dave Longley",
        "Gregg Kellogg",
        "Pierre-Antoine Champin"
      ],
      "status": "Candidate Recommendation",
      "publisher": "W3C",
      "id": "json-ld"
    },
    "PAIRING-FRIENDLY-CURVES": {
      "title": "Pairing-Friendly Curves",
      "href": "https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-03",
      "authors": [
        "Yumi Sakemi",
        "Tetsutaro Kobayashi",
        "Tsunekazu Saito"
      ],
      "status": "Internet Draft",
      "publisher": "IETF",
      "id": "pairing-friendly-curves"
    },
    "VC-DATA-MODEL-2": {
      "title": "Verifiable Credentials Data Model v2.0",
      "href": "https://www.w3.org/TR/vc-data-model-2.0/",
      "authors": [
        "Manu Sporny",
        "Dave Longley",
        "Grant Noble",
        "Dan Burnett",
        "Ted Thibodeau",
        "Brent Zundel",
        "David Chadwick",
        "Kyle Den Hartog"
      ],
      "status": "Working Draft",
      "publisher": "W3C Verifiable Credentials Working Group",
      "id": "vc-data-model-2"
    },
    "SHORT-GROUP-SIGNATURES": {
      "title": "Short group signatures",
      "href": "https://crypto.stanford.edu/~xb/crypto04a/groupsigs.pdf",
      "authors": [
        "Dan Boneh",
        "Xavier Boyen",
        "Hovav Shacham"
      ],
      "status": "Published",
      "publisher": "Advances in Cryptology—CRYPTO 2004"
    },
    "MULTIBASE": {
      "title": "Multibase",
      "href": "https://tools.ietf.org/html/draft-multiformats-multibase-01",
      "id": "multibase"
    },
    "MULTICODEC": {
      "title": "Multicodec",
      "href": "https://github.com/multiformats/multicodec/",
      "id": "multicodec"
    },
    "CFRG-BBS-SIGNATURE": {
      "title": "The BBS Signature Scheme",
      "href": "https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html",
      "authors": [
        "Tobias Looker",
        "Vasilis Kalos",
        "Andrew Whitehead",
        "Mike Lodder"
      ],
      "status": "Draft",
      "id": "cfrg-bbs-signature"
    },
    "BBS": {
      "title": "BBS+ Signatures",
      "href": "https://mattrglobal.github.io/bbs-signatures-spec/",
      "authors": [
        "Michael Lodder",
        "Tobias Looker"
      ],
      "status": "Draft",
      "id": "bbs"
    },
    "BLAKE2": {
      "title": "Blake2 - fast secure hashing",
      "href": "https://www.blake2.net/",
      "id": "blake2"
    }
  },
  "lint": {
    "no-unused-dfns": false
  },
  "postProcess": [
    null
  ],
  "publishISODate": "2023-04-12T00:00:00.000Z",
  "generatedSubtitle": "Final Community Group Report 12 April 2023"
}</script>
<link rel="stylesheet" href="https://www.w3.org/StyleSheets/TR/2021/cg-final"></head>
  <body class="h-entry"><div class="head">
    
    <h1 id="title" class="title">BBS Cryptosuite v2023</h1> <h2 id="subtitle" class="subtitle">Achieving Data Integrity using Unlinkable BBS Signatures</h2>
    <p id="w3c-state">
      <a href="https://www.w3.org/standards/types#reports">Final Community Group Report</a>
      <time class="dt-published" datetime="2023-04-12">12 April 2023</time>
    </p>
    <dl>
      <dt>This version:</dt><dd>
              <a class="u-url" href="https://www.w3.org/community/reports/credentials/CG-FINAL-vc-di-bbs-20230412/">https://www.w3.org/community/reports/credentials/CG-FINAL-vc-di-bbs-20230412/</a>
            </dd>
      <dt>Latest published version:</dt><dd>
              <a href="https://www.w3.org/community/reports/credentials/CG-FINAL-vc-di-bbs-20230405/">https://www.w3.org/community/reports/credentials/CG-FINAL-vc-di-bbs-20230405/</a>
            </dd>
      <dt>Latest editor's draft:</dt><dd><a href="https://w3c-ccg.github.io/vc-di-bbs/">https://w3c-ccg.github.io/vc-di-bbs/</a></dd>
      
      
      
      
      <dt>Editors:</dt><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://mattr.global/">Tobias Looker</a> (<a class="p-org org h-org" href="https://mattr.global/">Mattr</a>)
  </dd><dd class="editor p-author h-card vcard">
    <a class="u-url url p-name fn" href="https://transmute.industries">Orie Steele</a> (<a class="p-org org h-org" href="https://transmute.industries">Transmute</a>)
  </dd>
      
      
      <dt>Feedback:</dt><dd><a href="mailto:public-credentials@w3.org?subject=%5Bvc-di-bbs%5D%20YOUR%20TOPIC%20HERE">public-credentials@w3.org</a> with subject line <kbd>[vc-di-bbs] <em>… message topic …</em></kbd> (<a rel="discussion" href="https://lists.w3.org/Archives/Public/public-credentials">archives</a>)</dd>
    </dl>
    
    <p class="copyright">
          <a href="https://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a>
          ©
          2023
          
          the Contributors to the BBS Cryptosuite v2023
          Specification, published by the
          <a href="https://www.w3.org/groups/cg/credentials">Credentials Community Group</a> under the
          <a href="https://www.w3.org/community/about/agreements/fsa/">W3C Community Final Specification Agreement (FSA)</a>. A human-readable
                <a href="https://www.w3.org/community/about/agreements/fsa-deed/">summary</a>
                is available.
              
        </p>
    <hr title="Separator for header">
  </div>
    <section id="abstract" class="introductory"><h2>Abstract</h2>
      <p>
This specification describes the BBS+ Signature Suite created in 2020
for the Data Integrity specification. The Signature Suite utilizes
BBS+ signatures to provide the capability of zero knowledge
proof disclosures.
      </p>
    </section>

    <section id="sotd" class="introductory"><h2>Status of This Document</h2><p>
      This specification was published by the
      <a href="https://www.w3.org/groups/cg/credentials">Credentials Community Group</a>. It is not a W3C Standard nor is it
      on the W3C Standards Track.
      
            Please note that under the
            <a href="https://www.w3.org/community/about/agreements/final/">W3C Community Final Specification Agreement (FSA)</a>
            other conditions apply.
          
      Learn more about
      <a href="https://www.w3.org/community/">W3C Community and Business Groups</a>.
    </p>
      <p>
This is an experimental specification and is undergoing regular revisions. It
is not fit for production deployment.
      </p>
    <p>
    If you wish to make comments regarding this document, please send them to
    <a href="mailto:public-credentials@w3.org">public-credentials@w3.org</a>
    (<a href="mailto:public-credentials-request@w3.org?subject=subscribe">subscribe</a>,
    <a href="https://lists.w3.org/Archives/Public/public-credentials/">archives</a>).
  </p></section><nav id="toc"><h2 class="introductory" id="table-of-contents">Table of Contents</h2><ol class="toc"><li class="tocline"><a class="tocxref" href="#abstract">Abstract</a></li><li class="tocline"><a class="tocxref" href="#sotd">Status of This Document</a></li><li class="tocline"><a class="tocxref" href="#introduction"><bdi class="secno">1. </bdi>Introduction</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#terminology"><bdi class="secno">1.1 </bdi>Terminology</a></li><li class="tocline"><a class="tocxref" href="#conformance"><bdi class="secno">1.2 </bdi>Conformance</a></li></ol></li><li class="tocline"><a class="tocxref" href="#data-model"><bdi class="secno">2. </bdi>Data Model</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#verification-methods"><bdi class="secno">2.1 </bdi>Verification Methods</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#multikey"><bdi class="secno">2.1.1 </bdi>Multikey</a></li><li class="tocline"><a class="tocxref" href="#jsonwebkey"><bdi class="secno">2.1.2 </bdi>JsonWebKey</a></li></ol></li><li class="tocline"><a class="tocxref" href="#proof-representations"><bdi class="secno">2.2 </bdi>Proof Representations</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#dataintegrityproof"><bdi class="secno">2.2.1 </bdi>DataIntegrityProof</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#algorithms"><bdi class="secno">3. </bdi>Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#bbs-2023"><bdi class="secno">3.1 </bdi>bbs-2023</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#add-proof-bbs-2023"><bdi class="secno">3.1.1 </bdi>Add Proof (bbs-2023)</a></li><li class="tocline"><a class="tocxref" href="#verify-proof-bbs-2023"><bdi class="secno">3.1.2 </bdi>Verify Proof (bbs-2023)</a></li><li class="tocline"><a class="tocxref" href="#transformation-bbs-2023"><bdi class="secno">3.1.3 </bdi>Transformation (bbs-2023)</a></li><li class="tocline"><a class="tocxref" href="#hashing-bbs-2023"><bdi class="secno">3.1.4 </bdi>Hashing (bbs-2023)</a></li><li class="tocline"><a class="tocxref" href="#proof-configuration-bbs-2023"><bdi class="secno">3.1.5 </bdi>Proof Configuration (bbs-2023)</a></li><li class="tocline"><a class="tocxref" href="#proof-serialization-bbs-2023"><bdi class="secno">3.1.6 </bdi>Proof Serialization (bbs-2023)</a></li><li class="tocline"><a class="tocxref" href="#proof-verification-bbs-2023"><bdi class="secno">3.1.7 </bdi>Proof Verification (bbs-2023)</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#security-considerations"><bdi class="secno">4. </bdi>Security Considerations</a></li><li class="tocline"><a class="tocxref" href="#bbs-signature-2020"><bdi class="secno">A. </bdi>BBS+ Signature 2020</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#bls12-381"><bdi class="secno">A.1 </bdi>BLS12-381</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#bls-12-381-g1-public-key"><bdi class="secno">A.1.1 </bdi><span>Bls 12-381 G1 Public Key</span></a></li><li class="tocline"><a class="tocxref" href="#bls-12-381-g2-public-key"><bdi class="secno">A.1.2 </bdi><span>Bls 12-381 G2 Public Key</span></a></li></ol></li><li class="tocline"><a class="tocxref" href="#the-bbs-signature-suite-2020"><bdi class="secno">A.2 </bdi>The BBS+ Signature Suite 2020</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#modification-to-algorithms"><bdi class="secno">A.2.1 </bdi>Modification to Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-verify-data-algorithm"><bdi class="secno">A.2.1.1 </bdi>Create Verify Data Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#terms"><bdi class="secno">A.2.2 </bdi>Terms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-type"><bdi class="secno">A.2.2.1 </bdi>Proof Type</a></li><li class="tocline"><a class="tocxref" href="#created"><bdi class="secno">A.2.2.2 </bdi>Created</a></li><li class="tocline"><a class="tocxref" href="#context"><bdi class="secno">A.2.2.3 </bdi>@context</a></li><li class="tocline"><a class="tocxref" href="#verification-method"><bdi class="secno">A.2.2.4 </bdi>Verification Method</a></li><li class="tocline"><a class="tocxref" href="#proof-purpose"><bdi class="secno">A.2.2.5 </bdi>Proof Purpose</a></li><li class="tocline"><a class="tocxref" href="#required-reveal-statements"><bdi class="secno">A.2.2.6 </bdi>Required Reveal Statements</a></li><li class="tocline"><a class="tocxref" href="#proof-value"><bdi class="secno">A.2.2.7 </bdi>Proof Value</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#the-bbs-signature-proof-suite-2020"><bdi class="secno">A.3 </bdi>The BBS+ Signature Proof Suite 2020</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#terms-0"><bdi class="secno">A.3.1 </bdi>Terms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-type-0"><bdi class="secno">A.3.1.1 </bdi>Proof Type</a></li><li class="tocline"><a class="tocxref" href="#created-0"><bdi class="secno">A.3.1.2 </bdi>Created</a></li><li class="tocline"><a class="tocxref" href="#verification-method-0"><bdi class="secno">A.3.1.3 </bdi>Verification Method</a></li><li class="tocline"><a class="tocxref" href="#proof-purpose-0"><bdi class="secno">A.3.1.4 </bdi>Proof Purpose</a></li><li class="tocline"><a class="tocxref" href="#proof-value-0"><bdi class="secno">A.3.1.5 </bdi>Proof Value</a></li><li class="tocline"><a class="tocxref" href="#nonce"><bdi class="secno">A.3.1.6 </bdi>Nonce</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#the-bbs-bound-signature-suite-2020"><bdi class="secno">A.4 </bdi>The BBS+ Bound Signature Suite 2020</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#modification-to-algorithms-0"><bdi class="secno">A.4.1 </bdi>Modification to Algorithms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-verify-data-algorithm-0"><bdi class="secno">A.4.1.1 </bdi>Create Verify Data Algorithm</a></li></ol></li><li class="tocline"><a class="tocxref" href="#terms-1"><bdi class="secno">A.4.2 </bdi>Terms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-type-1"><bdi class="secno">A.4.2.1 </bdi>Proof Type</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#the-bbs-bound-signature-proof-suite-2020"><bdi class="secno">A.5 </bdi>The BBS+ Bound Signature Proof Suite 2020</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#terms-2"><bdi class="secno">A.5.1 </bdi>Terms</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#proof-type-2"><bdi class="secno">A.5.1.1 </bdi>Proof Type</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#derive-proof-algorithm"><bdi class="secno">A.6 </bdi>Derive Proof Algorithm</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#create-derive-proof-data-algorithm"><bdi class="secno">A.6.1 </bdi>Create Derive Proof Data Algorithm</a></li></ol></li></ol></li><li class="tocline"><a class="tocxref" href="#acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements</a></li><li class="tocline"><a class="tocxref" href="#references"><bdi class="secno">C. </bdi>References</a><ol class="toc"><li class="tocline"><a class="tocxref" href="#normative-references"><bdi class="secno">C.1 </bdi>Normative references</a></li><li class="tocline"><a class="tocxref" href="#informative-references"><bdi class="secno">C.2 </bdi>Informative references</a></li></ol></li></ol></nav>

    <section id="introduction"><div class="header-wrapper"><h2 id="x1-introduction"><bdi class="secno">1. </bdi>Introduction</h2><a class="self-link" href="#introduction" aria-label="Permalink for Section 1."></a></div>
      
      <p>
This specification defines a set of cryptographic suites for the purpose of creating, verifying and deriving proofs
for BBS+ Signatures in conformance with the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] specification.
      </p>
      <p>
In general the suites uses the RDF Dataset Normalization Algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-normalization" title="RDF Dataset Normalization 1.0">RDF-DATASET-NORMALIZATION</a></cite>] to transform an
input document into its canonical form. It then uses the <a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-1">statement digest algorithm</a>
to digest each statement to be signed individually, finally the digested statements are signed
using the defined <a href="#dfn-signature-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-algorithm-1">signature algorithm</a>.
      </p>
      <p>
BBS+ signatures [<cite><a class="bibref" data-link-type="biblio" href="#bib-bbs" title="BBS+ Signatures">BBS</a></cite>] are compatible with any pairing friendly elliptic curve, however the cryptographic
suites defined in this document elect to only allow the usage of the BLS12-381 for interoperability purposes.
      </p>

    <section id="terminology"><div class="header-wrapper"><h3 id="x1-1-terminology"><bdi class="secno">1.1 </bdi>Terminology</h3><a class="self-link" href="#terminology" aria-label="Permalink for Section 1.1"></a></div>
      
      <p>
The following terms are used to describe concepts involved in the
generation and verification of the Data Integrity
<a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-1">signature suite</a>.
      </p>

      <div><p>
This section defines the terms used in this specification. A link to these terms
is included whenever they appear in this specification.
</p>

<dl class="termlist">
  <dt><dfn data-plurals="data integrity proofs" id="dfn-data-integrity-proof" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">data integrity proof</dfn></dt>
  <dd>
A set of attributes that represent a digital proof and the parameters required
to verify it.
  </dd>
  
  
  <dt><dfn id="dfn-private-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">private key</dfn></dt>
  <dd>
Cryptographic material that can be used to generate digital proofs.
  </dd>
  
  
  
  
  
  
  <dt><dfn id="dfn-challenge" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">challenge</dfn></dt>
  <dd>
A random or pseudo-random value used by some authentication protocols to
mitigate replay attacks.
  </dd>
  <dt><dfn id="dfn-domain" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">domain</dfn></dt>
  <dd>
A string value that specifies the operational domain of a digital proof.
This could be an Internet domain name like <code>example.com</code>, an
ad-hoc value such as <code>mycorp-level3-access</code>, or a very
specific transaction value like <code>8zF6T8J34qP3mqP</code>. A signer could
include a <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-2">domain</a> in its digital proof to restrict its use
to particular target, identified by the specified <a href="#dfn-domain" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-domain-3">domain</a>.
  </dd>

  
  

  <dt><dfn data-lt="cryptosuite|cryptographic suite" id="dfn-cryptosuite" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">cryptographic suite</dfn></dt>
  <dd>
A specification defining the usage of specific cryptographic primitives in
order to achieve a particular security goal. These documents are often used
to specify <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-1">verification methods</a>, digital signature types,
their identifiers, and other related properties.
  </dd>

  <dt><dfn data-lt="decentralized identifiers|DID|DIDs|decentralized identifier" data-plurals="did" id="dfn-decentralized-identifiers" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">decentralized identifier</dfn> (DID)</dt>

  <dd>
A globally unique persistent identifier that does not require a centralized
registration authority and is often generated and/or registered
cryptographically. The generic format of a is defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-did-core" title="Decentralized Identifiers (DIDs) v1.0">DID-CORE</a></cite>]. Many—but
not all—methods make use of <a href="#dfn-distributed-ledger-technology" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-distributed-ledger-technology-1">distributed ledger technology</a> (DLT) or some
other form of decentralized network.
  </dd>

  <dt><dfn data-lt="controller(s)|controller" id="dfn-controller-s" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controller</dfn></dt>

  <dd>
An entity that has the capability to make changes to a
<a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-1">controller document</a>.
  </dd>

  <dt><dfn data-lt="controller documents|controller document" id="dfn-controller-documents" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">controller document</dfn></dt>

  <dd>
A set of data that specifies one or more relationships between a
<a href="#dfn-controller-s" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-s-2">controller</a> and a set of data, such as a set of public cryptographic keys.
  </dd>

  <dt><dfn data-lt="subjects|subject" id="dfn-subjects" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">subject</dfn></dt>

  <dd>
The entity identified by the <code>id</code> property in a <a href="#dfn-controller-documents" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-controller-documents-2">controller document</a>.
Anything can be a subject: person, group, organization, physical thing, digital
thing, logical thing, etc.
  </dd>

  <dt><dfn data-lt="distributed ledger technology|DLT|distributed ledger" id="dfn-distributed-ledger-technology" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">distributed ledger</dfn> (DLT)</dt>

  <dd>
A non-centralized system for recording events. These systems establish
sufficient confidence for participants to rely upon the data recorded by others
to make operational decisions. They typically use distributed databases where
different nodes use a consensus protocol to confirm the ordering of
cryptographically signed transactions. The linking of digitally signed
transactions over time often makes the history of the ledger effectively
immutable.
  </dd>

  

  

  
  

  

  

  <dt><dfn data-lt="" data-plurals="verification methods" id="dfn-verification-method" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">verification method</dfn></dt>

  <dd>
    <p>
A set of parameters that can be used together with a process to independently
verify a proof. For example, a cryptographic public key can be used as a
verification method with respect to a digital signature; in such usage, it
verifies that the signer possessed the associated cryptographic private key.
    </p>
    <p>
"Verification" and "proof" in this definition are intended to apply broadly. For
example, a cryptographic public key might be used during Diffie-Hellman key
exchange to negotiate a shared symmetric key for encryption. This guarantees the
integrity of the key agreement process. It is thus another type of verification
method, even though descriptions of the process might not use the words
"verification" or "proof."
    </p>
  </dd>

  

  

</dl>
</div>

      <dl>
        <dt><dfn id="dfn-signature-suite" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">signature suite</dfn></dt>
        <dd>
A specified set of cryptographic primitives typically consisting of
a canonicalization algorithm, a message digest algorithm, and a signature
algorithm that are bundled together by cryptographers for developers
for the purposes of safety and convenience.
        </dd>
        <dt><dfn id="dfn-canonicalization-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">canonicalization algorithm</dfn></dt>
        <dd>
An algorithm that takes an input document that has more than one possible
representation and always transforms it into a <a href="#dfn-canonical-form" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonical-form-1">canonical form</a>. This process is
sometimes also called normalization.
        </dd>
        <dt><dfn id="dfn-canonical-form" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">canonical form</dfn></dt>
        <dd>
The output of applying a <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-1">canonicalization algorithm</a> to an input document.
        </dd>
        <dt><dfn data-plurals="statements" id="dfn-statement" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">statement</dfn></dt>
        <dd>
<a href="#dfn-n-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-n-quad-1">n-quads</a> statements are a sequence of RDF terms representing the subject, predicate, object and graph label.
See the grammar definition <a href="https://www.w3.org/TR/n-quads/#grammar-production-statement">here</a>.
        </dd>
        <dt><dfn data-lt="statement digest algorithm|statement digest algorithms" id="dfn-statement-digest-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">statement digest algorithm</dfn></dt>
        <dd>
An algorithm that takes a <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-1">statement</a> and produces a cryptographic
output message that is often many orders of magnitude smaller than the
input message. These algorithms are often 1) very fast, 2)
non-reversible, 3) cause the output to change significantly when even one
bit of the input message changes, and 4) make it infeasible to find two
different inputs for the same output.
        </dd>
        <dt><dfn data-lt="statement digest|statement digests" id="dfn-statement-digest" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">statement digest</dfn></dt>
          <dd>
The result of the application of the <a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-2">statement digest algorithm</a> to a <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-2">statement</a>
          </dd>
        <dt><dfn id="dfn-signature-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">signature algorithm</dfn></dt>
        <dd>
An algorithm that takes an input message and produces an output value where the
receiver of the message can mathematically verify that the message has not
been modified in transit and came from someone possessing a particular secret.
        </dd>
        <dt><dfn id="dfn-selective-disclosure" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">selective disclosure</dfn></dt>
        <dd>
An information disclosure technique which is the process of deciding and disclosing
a sub-set of information from an original information set.
        </dd>
      <dt><dfn id="dfn-data-integrity-proof-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">data integrity proof document</dfn></dt>
      <dd>
A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-1">linked data document</a> featuring one or more <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-2">data integrity proofs</a>.
      </dd>
      <dt><dfn data-lt="revealed statements" id="dfn-revealed-statements" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">revealed statements</dfn></dt>
      <dd>
The set of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-3">statements</a> produced by applying the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-2">canonicalization algorithm</a> to the <a href="#dfn-reveal-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-reveal-document-1">reveal document</a>.
      </dd>
      <dt><dfn id="dfn-derive-proof-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">derive proof algorithm</dfn></dt>
      <dd>
An algorithm that takes in a <a href="#dfn-data-integrity-proof-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-document-1">data integrity proof document</a> featuring a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-3">data integrity proof</a> that supports a
<a href="#dfn-derive-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-derive-proof-algorithm-1">derive proof algorithm</a> along side a <a href="#dfn-reveal-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-reveal-document-2">reveal document</a>
and derives a proof only revealing the <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-4">statement</a>s defined in the <a href="#dfn-reveal-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-reveal-document-3">reveal document</a>.
      </dd>
      <dt><dfn id="dfn-derived-proof" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">derived proof</dfn></dt>
      <dd>
The product of apply the <a href="#dfn-derive-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-derive-proof-algorithm-2">derive proof algorithm</a> to an <a href="#dfn-data-integrity-proof-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-document-2">data integrity proof document</a> and <a href="#dfn-reveal-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-reveal-document-4">reveal document</a>.
      </dd>
      <dt><dfn data-lt="quad|quads" id="dfn-quad" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">quad</dfn></dt>
      <dd>
A <a href="https://json-ld.github.io/normalization/spec/index.html#dfn-quad" class="externalDFN">quad</a> as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-normalization" title="RDF Dataset Normalization 1.0">RDF-DATASET-NORMALIZATION</a></cite>]
      </dd>
      <dt><dfn data-lt="n-quad|n-quads" id="dfn-n-quad" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">n-quad</dfn></dt>
      <dd>
An <a href="https://www.w3.org/TR/n-quads/" class="externalDFN">n-quad</a> which is a line based, plain text format encoding of a <a href="#dfn-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-quad-1">quad</a> as defined by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-n-quads" title="RDF 1.1 N-Quads">RDF-N-Quads</a></cite>].
      </dd>
      <dt><dfn data-lt="linked data document|linked data documents" id="dfn-linked-data-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">linked data document</dfn></dt>
      <dd>
A document comprised of linked data.
      </dd>
      <dt><dfn data-lt="curve name" id="dfn-curve-name" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">curve name</dfn></dt>
      <dd>
The name defining a particular cryptographic curve.
      </dd>
      <dt><dfn data-lt="frame" id="dfn-frame" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">frame</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/json-ld11/#dfn-frame" class="externalDFN">frame</a> as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld-framing" title="JSON-LD 1.1 Framing">JSON-LD-FRAMING</a></cite>]
is a <a href="#dfn-json-ld-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-json-ld-document-1">JSON-LD document</a>, which describes the form for transforming another JSON-LD
document using matching and embedding rules. A frame document allows additional
keywords and certain map entries to describe the matching and transforming process.
      </dd>
      <dt><dfn id="dfn-json-ld-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">JSON-LD document</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/json-ld11/#dfn-json-ld-document" class="externalDFN">JSON-LD document</a> as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld-framing" title="JSON-LD 1.1 Framing">JSON-LD-FRAMING</a></cite>]
is a is a serialization of an <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-rdf-dataset">RDF dataset</a>
      </dd>
      <dt><dfn id="dfn-framing-algorithm" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">framing algorithm</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/json-ld11-framing/#framing-algorithm" class="externalDFN">Framing Algorithm</a> as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld-framing" title="JSON-LD 1.1 Framing">JSON-LD-FRAMING</a></cite>]
is an algorithm that accomplishes the process of framing an input document to a given <a href="#dfn-frame" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-frame-1">frame</a>.
      </dd>
      <dt><dfn data-lt="Blank nodes|Blank node|blank node" id="dfn-blank-nodes" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">blank node</dfn></dt>
      <dd>
A <a href="https://www.w3.org/TR/rdf11-concepts/#dfn-blank-node" class="externalDFN">blank node</a> as specified by [<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-concepts" title="RDF 1.1 Concepts and Abstract Syntax">RDF-CONCEPTS</a></cite>].
In short, it is a node in a graph that is neither an IRI, nor a literal.
      </dd>
      </dl>
    </section>

      <section id="conformance"><div class="header-wrapper"><h3 id="x1-2-conformance"><bdi class="secno">1.2 </bdi>Conformance</h3><a class="self-link" href="#conformance" aria-label="Permalink for Section 1.2"></a></div><p>As well as sections marked as non-normative, all authoring guidelines, diagrams, examples, and notes in this specification are non-normative. Everything else in this specification is normative.</p><p>
        The key words <em class="rfc2119">MAY</em>, <em class="rfc2119">MUST</em>, <em class="rfc2119">MUST NOT</em>, and <em class="rfc2119">RECOMMENDED</em> in this document
        are to be interpreted as described in
        <a href="https://datatracker.ietf.org/doc/html/bcp14">BCP 14</a>
        [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc2119" title="Key words for use in RFCs to Indicate Requirement Levels">RFC2119</a></cite>] [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc8174" title="Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words">RFC8174</a></cite>]
        when, and only when, they appear in all capitals, as shown here.
      </p>

      <div class="issue" id="issue-container-number-1"><div role="heading" class="issue-title marker" id="h-issue" aria-level="4"><span>Issue 1</span></div><div class="">TODO: Add paragraph</div></div>

      </section>
    </section>

    <section id="data-model"><div class="header-wrapper"><h2 id="x2-data-model"><bdi class="secno">2. </bdi>Data Model</h2><a class="self-link" href="#data-model" aria-label="Permalink for Section 2."></a></div>
      

      <p>
The following sections outline the data model that is used by this specification
for <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-3">verification methods</a> and <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-4">data integrity proof</a> formats.
      </p>

      <section id="verification-methods"><div class="header-wrapper"><h3 id="x2-1-verification-methods"><bdi class="secno">2.1 </bdi>Verification Methods</h3><a class="self-link" href="#verification-methods" aria-label="Permalink for Section 2.1"></a></div>
        
        <p>
The cryptographic material used to verify a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-5">data integrity proof</a> is
called the <a href="#dfn-verification-method" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-verification-method-4">verification method</a>. This suite relies on public key material
represented using [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="Multibase">MULTIBASE</a></cite>], [<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="Multicodec">MULTICODEC</a></cite>], and JSON Web Key [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>].
        </p>

        <p>
This suite <em class="rfc2119">MAY</em> be used to verify Data Integrity Proofs [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>]
produced by BLS12-381 public key material encoded as a
<a href="#multikey">Multikey</a>. Loss-less key transformation processes that
result in equivalent cryptographic material <em class="rfc2119">MAY</em> be utilized.
        </p>

        <section id="multikey"><div class="header-wrapper"><h4 id="x2-1-1-multikey"><bdi class="secno">2.1.1 </bdi>Multikey</h4><a class="self-link" href="#multikey" aria-label="Permalink for Section 2.1.1"></a></div>
          

          <div class="issue" id="issue-container-number-2"><div role="heading" class="issue-title marker" id="h-issue-0" aria-level="5"><span>Issue 2</span></div><p class="">
This definition should go in the Data Integrity specification and referenced
from there.
          </p></div>

          <p>
The <code>type</code> of the verification method <em class="rfc2119">MUST</em> be <code>Multikey</code>.
          </p>

          <p>
The <code>controller</code> of the verification method <em class="rfc2119">MUST</em> be a URL.
          </p>

          <p>
The <code>publicKeyMultibase</code> property of the verification method <em class="rfc2119">MUST</em> be a public
key encoded according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="Multicodec">MULTICODEC</a></cite>] and formatted according to
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="Multibase">MULTIBASE</a></cite>]. The multicodec encoding of a BLS12-381 public key that combines
both the G1 and G2 fields is the byte prefix <code>0xee</code> followed by the 48-byte G1
public key data, which is then followed by the 96-byte G2 public key data. The
145 byte value is then encoded using base64url with no padding (<code>u</code>) as the
prefix. Any other encodings <em class="rfc2119">MUST NOT</em> be allowed.
          </p>

          <p class="advisement">
Developers are advised to not accidentally publish a representation of a private
key. Implementations of this specification will raise errors in the event of a
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="Multicodec">MULTICODEC</a></cite>] value other than <code>0xee</code> being used in a <code>publicKeyMultibase</code>
value.
          </p>

          <div class="example" id="example-an-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-multikey">
        <div class="marker">
    <a class="self-link" href="#example-an-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-multikey">Example<bdi> 1</bdi></a><span class="example-title">: An BLS12-381 public key containing the G1 and G2 values, encoded as a Multikey</span>
  </div> <pre aria-busy="false"><code class="hljs">{
  "id": "https://example.com/issuer/123#key-0",
  "type": "Multikey",
  "controller": "https://example.com/issuer/123",
  "publicKeyMultibase": "u7ljnAxKdp7YVqJvcMU9GtnmrMc1XZztXHsTsZ2LsmGJ67SsdbmNc
    S2SDs0daEPfhVXgODk0IVrgguJ-TJACHyXYa9Ae8DaxcvRy89KLgmWsyOOJn2oY7vCE2gt
    JoebMJiQsdbmNcS2SDs0daEPfhVXgODk0IVrgguJ-TJACHyXYa9Ae8DaxcvRy89KLgm"
}</code></pre>
      </div>

          <div class="example" id="example-a-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-multikey-in-a-controller-document">
        <div class="marker">
    <a class="self-link" href="#example-a-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-multikey-in-a-controller-document">Example<bdi> 2</bdi></a><span class="example-title">: A BLS12-381 public key containing the
            G1 and G2 values, encoded as a Multikey in a controller document</span>
  </div> <pre aria-busy="false"><code class="hljs">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/data-integrity/v1"
  ],
  "id": "did:example:123",
  "verificationMethod": [{
    "id": "https://example.com/issuer/123#key-1",
    "type": "Multikey",
    "controller": "https://example.com/issuer/123",
    "publicKeyMultibase": "zDnaerx9CtbPJ1q36T5Ln5wYt3MQYeGRG5ehnPAmxcf5mDZpv"
  }, {
    "id": "https://example.com/issuer/123#key-2",
    "type": "Multikey",
    "controller": "https://example.com/issuer/123",
    "publicKeyMultibase": "u7ljnAxKdp7YVqJvcMU9GtnmrMc1XZztXHsTsZ2LsmGJ67SsdbmNc
      S2SDs0daEPfhVXgODk0IVrgguJ-TJACHyXYa9Ae8DaxcvRy89KLgmWsyOOJn2oY7vCE2gt
      JoebMJiQsdbmNcS2SDs0daEPfhVXgODk0IVrgguJ-TJACHyXYa9Ae8DaxcvRy89KLgm"
  }],
  "authentication": [
    "did:example:123#key-1"
  ],
  "assertionMethod": [
    "did:example:123#key-2"
  ],
  "capabilityDelegation": [
    "did:example:123#key-1"
  ],
  "capabilityInvocation": [
    "did:example:123#key-1"
  ]
}</code></pre>
      </div>
        </section>

        <section id="jsonwebkey"><div class="header-wrapper"><h4 id="x2-1-2-jsonwebkey"><bdi class="secno">2.1.2 </bdi>JsonWebKey</h4><a class="self-link" href="#jsonwebkey" aria-label="Permalink for Section 2.1.2"></a></div>
          

          <div class="issue" id="issue-container-number-3"><div role="heading" class="issue-title marker" id="h-issue-1" aria-level="5"><span>Issue 3</span></div><p class="">
This definition should go in the Data Integrity specification and referenced
from there.
          </p></div>

          <p>
The <code>type</code> of the verification method <em class="rfc2119">MUST</em> be <code>JsonWebKey</code>.
          </p>

          <p>
The <code>controller</code> of the verification method <em class="rfc2119">MUST</em> be a URL.
          </p>

          <p>
The <code>publicKeyJwk</code> property of the verification method <em class="rfc2119">MUST</em> be a public
key encoded according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-rfc7517" title="JSON Web Key (JWK)">RFC7517</a></cite>]. Any other encodings <em class="rfc2119">MUST NOT</em> be allowed.
          </p>

          <div class="issue" id="issue-container-number-4"><div role="heading" class="issue-title marker" id="h-issue-2" aria-level="5"><span>Issue 4</span></div><p class="">
The specific encoding of BBS public key parameters are being discussed in the
JOSE Working Group.
          </p></div>

          <p class="advisement">
Developers are advised to not accidentally publish a representation of a private
key. Implementations of this specification <em class="rfc2119">MUST</em> raise errors in the event of
the expression of a key parameter that is marked as <code>Private</code> in the IANA
JSON Web Key Parameters registry in public key information.
          </p>

          <div class="example" id="example-an-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-jsonwebkey">
        <div class="marker">
    <a class="self-link" href="#example-an-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-jsonwebkey">Example<bdi> 3</bdi></a><span class="example-title">: An BLS12-381 public key containing the G1 and G2 values, encoded as a JsonWebKey</span>
  </div> <pre aria-busy="false"><code class="hljs">{
  "id": "did:example:123#key-3",
  "type": "JsonWebKey",
  "controller": "did:example:123",
  "publicKeyJwk": [{
    "kty": "EC",
    "crv": "BLS12381_G1",
    "x": "tCgCNuUYQotPEsrljWi-lIRIPpzhqsnJV1NPnE7je6glUb-FJm9IYkuv2hbHw22i"
  }, {
    "kty": "EC",
    "crv": "BLS12381_G2",
    "x": "h_rkcTKXXzRbOPr9UxSfegCbid2U_cVNXQUaKeGF7UhwrMJFP70uMH0VQ9-3-_2zDP
      AAjflsdeLkOXW3-ShktLxuPy8UlXSNgKNmkfb-rrj-FRwbs13pv_WsIf-eV66-"
  }]
}</code></pre>
      </div>

          <div class="example" id="example-a-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-jsonwebkey-in-a-controller-document">
        <div class="marker">
    <a class="self-link" href="#example-a-bls12-381-public-key-containing-the-g1-and-g2-values-encoded-as-a-jsonwebkey-in-a-controller-document">Example<bdi> 4</bdi></a><span class="example-title">: A BLS12-381 public key containing the
            G1 and G2 values, encoded as a JsonWebKey in a controller document</span>
  </div> <pre aria-busy="false"><code class="hljs">{
  "@context": [
    "https://www.w3.org/ns/did/v1",
    "https://w3id.org/security/data-integrity/v1"
  ],
  "id": "did:example:123",
  "verificationMethod": [{
    "id": "https://example.com/issuer/123#key-3",
    "type": "Multikey",
    "controller": "https://example.com/issuer/123",
    "publicKeyMultibase": "zDnaerx9CtbPJ1q36T5Ln5wYt3MQYeGRG5ehnPAmxcf5mDZpv"
  }, {
    "id": "did:example:123#key-3",
    "type": "JsonWebKey",
    "controller": "did:example:123",
    "publicKeyJwk": [{
      "kty": "EC",
      "crv": "BLS12381_G1",
      "x": "tCgCNuUYQotPEsrljWi-lIRIPpzhqsnJV1NPnE7je6glUb-FJm9IYkuv2hbHw22i"
    }, {
      "kty": "EC",
      "crv": "BLS12381_G2",
      "x": "h_rkcTKXXzRbOPr9UxSfegCbid2U_cVNXQUaKeGF7UhwrMJFP70uMH0VQ9-3-_2zDP
        AAjflsdeLkOXW3-ShktLxuPy8UlXSNgKNmkfb-rrj-FRwbs13pv_WsIf-eV66-"
    }]
  }],
  "authentication": [
    "did:example:123#key-3"
  ],
  "assertionMethod": [
    "did:example:123#key-4"
  ],
  "capabilityDelegation": [
    "did:example:123#key-3"
  ],
  "capabilityInvocation": [
    "did:example:123#key-3"
  ]
}</code></pre>
      </div>
        </section>

      </section>

    <section id="proof-representations"><div class="header-wrapper"><h3 id="x2-2-proof-representations"><bdi class="secno">2.2 </bdi>Proof Representations</h3><a class="self-link" href="#proof-representations" aria-label="Permalink for Section 2.2"></a></div>
      

      <p>
This suite relies on detached digital signatures represented using [<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="Multibase">MULTIBASE</a></cite>]
and [<cite><a class="bibref" data-link-type="biblio" href="#bib-multicodec" title="Multicodec">MULTICODEC</a></cite>].
      </p>

      <section id="dataintegrityproof"><div class="header-wrapper"><h4 id="x2-2-1-dataintegrityproof"><bdi class="secno">2.2.1 </bdi>DataIntegrityProof</h4><a class="self-link" href="#dataintegrityproof" aria-label="Permalink for Section 2.2.1"></a></div>
        

        <p>
The <code>verificationMethod</code> property of the proof <em class="rfc2119">MUST</em> be a URL.
Dereferencing the <code>verificationMethod</code> <em class="rfc2119">MUST</em> result in an object
containing a <code>type</code> property with the value set to
<code>Multikey</code> or <code>JsonWebKey</code>.
        </p>

        <p>
The <code>type</code> property of the proof <em class="rfc2119">MUST</em> be <code>DataIntegrityProof</code>.
        </p>
        <p>
The <code>cryptosuite</code> property of the proof <em class="rfc2119">MUST</em> be <code>bbs-2023</code>.
        </p>
        <p>
The <code>created</code> property of the proof <em class="rfc2119">MUST</em> be an [<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>]
formated date string.
        </p>
        <p>
The <code>proofPurpose</code> property of the proof <em class="rfc2119">MUST</em> be a string, and <em class="rfc2119">MUST</em>
match the verification relationship expressed by the verification method
<code>controller</code>.
        </p>
        <p>
The <code>proofValue</code> property of the proof <em class="rfc2119">MUST</em> be a detached BBS Signature
produced according to [<cite><a class="bibref" data-link-type="biblio" href="#bib-cfrg-bbs-signature" title="The BBS Signature Scheme">CFRG-BBS-SIGNATURE</a></cite>], encoded according to
[<cite><a class="bibref" data-link-type="biblio" href="#bib-multibase" title="Multibase">MULTIBASE</a></cite>] using the base64 base encoding with no padding.
        </p>

        <div class="example" id="example-an-bbs-digital-signature-expressed-as-a-dataintegrityproof">
        <div class="marker">
    <a class="self-link" href="#example-an-bbs-digital-signature-expressed-as-a-dataintegrityproof">Example<bdi> 5</bdi></a><span class="example-title">: An BBS digital signature expressed as a DataIntegrityProof</span>
  </div> <pre class="highlight" style="overflow-x:
          auto; white-space: pre-wrap; word-wrap: break-word;" aria-busy="false"><code class="hljs">{
  "@context": [
    {"title": "https://schema.org/title"},
    "https://w3id.org/security/data-integrity/v1"
  ],
  "title": "Hello world!",
  "proof": {
    "type": "DataIntegrityProof",
    "cryptosuite": "bbs-2023",
    "created": "2020-11-05T19:23:24Z",
    "verificationMethod": "https://example.com/issuer/123#key-2",
    "proofPurpose": "assertionMethod",
    "proofValue": "mU6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdB
      Dd/l6tIYkTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDB
      5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1o
      AhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIM
      0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6oba
      Enaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYG
      nu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBk
      Oh6ojlvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/aGQcoD3Tgmy+z0hN+4elMky1RnJEhCuN
      QNsEg"
  }
}</code></pre>
      </div>

      </section>
    </section>
  </section>


  <section id="algorithms"><div class="header-wrapper"><h2 id="x3-algorithms"><bdi class="secno">3. </bdi>Algorithms</h2><a class="self-link" href="#algorithms" aria-label="Permalink for Section 3."></a></div>
    

    <p>
The following section describes multiple Data Integrity cryptographic suites
that utilize the BBS Signature Algorithm [<cite><a class="bibref" data-link-type="biblio" href="#bib-cfrg-bbs-signature" title="The BBS Signature Scheme">CFRG-BBS-SIGNATURE</a></cite>].
    </p>

    <section id="bbs-2023"><div class="header-wrapper"><h3 id="x3-1-bbs-2023"><bdi class="secno">3.1 </bdi>bbs-2023</h3><a class="self-link" href="#bbs-2023" aria-label="Permalink for Section 3.1"></a></div>
    

    <p>
The <code>bbs-2023</code> cryptographic suite takes an input document, canonicalizes
the document using the Universal RDF Dataset Canonicalization Algorithm
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>], and then cryptographically hashes and signs the output
resulting in the production of a data integrity proof. The algorithms in this
section also include the verification of such a data integrity proof.
    </p>

    <section id="add-proof-bbs-2023"><div class="header-wrapper"><h4 id="x3-1-1-add-proof-bbs-2023"><bdi class="secno">3.1.1 </bdi>Add Proof (bbs-2023)</h4><a class="self-link" href="#add-proof-bbs-2023" aria-label="Permalink for Section 3.1.1"></a></div>
      

      <p>
To generate a proof, the algorithm in
<a href="https://www.w3.org/TR/vc-data-integrity/#add-proof">
Section 4.1: Add Proof</a> in the Data Integrity
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification <em class="rfc2119">MUST</em> be executed.
For that algorithm, the cryptographic suite specific
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-transformation-algorithm">
transformation algorithm</a> is defined in Section
<a href="#transformation-bbs-2023" class="sec-ref"><bdi class="secno">3.1.3 </bdi>Transformation (bbs-2023)</a>, the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-hashing-algorithm">
hashing algorithm</a> is defined in Section <a href="#hashing-bbs-2023" class="sec-ref"><bdi class="secno">3.1.4 </bdi>Hashing (bbs-2023)</a>,
and the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-proof-serialization-algorithm">
proof serialization algorithm</a> is defined in Section
<a href="#proof-serialization-bbs-2023" class="sec-ref"><bdi class="secno">3.1.6 </bdi>Proof Serialization (bbs-2023)</a>.
      </p>
    </section>

    <section id="verify-proof-bbs-2023"><div class="header-wrapper"><h4 id="x3-1-2-verify-proof-bbs-2023"><bdi class="secno">3.1.2 </bdi>Verify Proof (bbs-2023)</h4><a class="self-link" href="#verify-proof-bbs-2023" aria-label="Permalink for Section 3.1.2"></a></div>
      

      <p>
To verify a proof, the algorithm in
<a href="https://www.w3.org/TR/vc-data-integrity/#verify-proof">
Section 4.2: Verify Proof</a> in the Data Integrity
[<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification <em class="rfc2119">MUST</em> be executed.
For that algorithm, the cryptographic suite specific
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-transformation-algorithm">
transformation algorithm</a> is defined in Section
<a href="#transformation-bbs-2023" class="sec-ref"><bdi class="secno">3.1.3 </bdi>Transformation (bbs-2023)</a>, the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-hashing-algorithm">
hashing algorithm</a> is defined in Section <a href="#hashing-bbs-2023" class="sec-ref"><bdi class="secno">3.1.4 </bdi>Hashing (bbs-2023)</a>,
and the
<a href="https://www.w3.org/TR/vc-data-integrity/#dfn-proof-serialization-algorithm">
proof verification algorithm</a> is defined in Section
<a href="#proof-verification-bbs-2023" class="sec-ref"><bdi class="secno">3.1.7 </bdi>Proof Verification (bbs-2023)</a>.
      </p>
    </section>

    <section id="transformation-bbs-2023"><div class="header-wrapper"><h4 id="x3-1-3-transformation-bbs-2023"><bdi class="secno">3.1.3 </bdi>Transformation (bbs-2023)</h4><a class="self-link" href="#transformation-bbs-2023" aria-label="Permalink for Section 3.1.3"></a></div>
      

      <p>
The following algorithm specifies how to transform an unsecured input document
into a transformed document that is ready to be provided as input to the
hashing algorithm in Section <a href="#hashing-bbs-2023" class="sec-ref"><bdi class="secno">3.1.4 </bdi>Hashing (bbs-2023)</a>.
      </p>


Required inputs to this algorithm are an
<a href="https://w3c.github.io/vc-data-integrity/#dfn-unsecured-data-document">
unsecured data document</a> (<var>unsecuredDocument</var>) and
<a href="https://w3c.github.io/vc-data-integrity/#dfn-transformation-options">
transformation options</a> (<var>options</var>). The
<a href="https://w3c.github.io/vc-data-integrity/#dfn-unsecured-data-document">
transformation options</a> <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://w3c.github.io/vc-data-integrity/#dfn-cryptographic-suite">
cryptographic suite</a> (<var>type</var>) and a cryptosuite
identifier (<var>cryptosuite</var>). A <em>transformed data document</em> is
produced as output. Whenever this algorithm encodes strings, it <em class="rfc2119">MUST</em> use UTF-8
encoding.
      <p></p>

      <ol class="algorithm">
        <li>
If <var>options</var>.<var>type</var> is not set to the string
<code>DataIntegrityProof</code> and <var>options</var>.<var>cryptosuite</var> is not
set to the string <code>bbs-2023</code> then a <code>PROOF_TRANSFORMATION_ERROR</code> <em class="rfc2119">MUST</em> be
raised.
        </li>
        <li>
Let <var>canonicalDocument</var> be the result of applying the
Universal RDF Dataset Canonicalization Algorithm
[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-canon" title="RDF Dataset Canonicalization">RDF-CANON</a></cite>] to the <var>unsecuredDocument</var>.
        </li>
        <li>
Set <var>output</var> to the value of <var>canonicalDocument</var>.
        </li>
        <li>
Return <var>canonicalDocument</var> as the <em>transformed data document</em>.
        </li>
      </ol>
    </section>

    <section id="hashing-bbs-2023"><div class="header-wrapper"><h4 id="x3-1-4-hashing-bbs-2023"><bdi class="secno">3.1.4 </bdi>Hashing (bbs-2023)</h4><a class="self-link" href="#hashing-bbs-2023" aria-label="Permalink for Section 3.1.4"></a></div>
      

      <p>
The following algorithm specifies how to cryptographically hash a
<em>transformed data document</em> and <em>proof configuration</em>
into cryptographic hash data that is ready to be provided as input to the
algorithms in Section <a href="#proof-serialization-bbs-2023" class="sec-ref"><bdi class="secno">3.1.6 </bdi>Proof Serialization (bbs-2023)</a> or
Section <a href="#proof-verification-bbs-2023" class="sec-ref"><bdi class="secno">3.1.7 </bdi>Proof Verification (bbs-2023)</a>.
      </p>

      <p>
The required inputs to this algorithm are a <em>transformed data document</em>
(<var>transformedDocument</var>) and <em>proof configuration</em>
(<var>proofConfig</var>). A single <em>hash data</em> value represented as
series of bytes is produced as output.
      </p>

      <ol class="algorithm">
        <div class="issue" id="issue-container-number-5"><div role="heading" class="issue-title marker" id="h-issue-3" aria-level="5"><span>Issue 5</span></div><li class="">
Specify how each item in the canonicalized input is hashed and included a set
that is then signed over in <a href="#proof-serialization-bbs-2023" class="sec-ref"><bdi class="secno">3.1.6 </bdi>Proof Serialization (bbs-2023)</a>.
        </li></div>
        <div class="issue" id="issue-container-number-6"><div role="heading" class="issue-title marker" id="h-issue-4" aria-level="5"><span>Issue 6</span></div><li class="">
Specify how <var>proofConfigHash</var> is generated.
        </li></div>
        <div class="issue" id="issue-container-number-7"><div role="heading" class="issue-title marker" id="h-issue-5" aria-level="5"><span>Issue 7</span></div><li class="">
Specify how <var>hashData</var> is composed in a way that can be signed over in
<a href="#proof-serialization-bbs-2023" class="sec-ref"><bdi class="secno">3.1.6 </bdi>Proof Serialization (bbs-2023)</a>.
        </li></div>
        <li>
Return <var>hashData</var> as the <em>hash data</em>.
        </li>
      </ol>

    </section>

    <section id="proof-configuration-bbs-2023"><div class="header-wrapper"><h4 id="x3-1-5-proof-configuration-bbs-2023"><bdi class="secno">3.1.5 </bdi>Proof Configuration (bbs-2023)</h4><a class="self-link" href="#proof-configuration-bbs-2023" aria-label="Permalink for Section 3.1.5"></a></div>
      

      <p>
The following algorithm specifies how to generate a
<em>proof configuration</em> from a set of <em>proof options</em>
that is used as input to the <a href="#hashing-bbs-2023">proof hashing algorithm</a>.
      </p>

      <p>
The required inputs to this algorithm are <em>proof options</em>
(<var>options</var>). The <em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier
for the
<a href="https://w3c.github.io/vc-data-integrity/#dfn-cryptographic-suite">
cryptographic suite</a> (<var>type</var>) and <em class="rfc2119">MUST</em> contain a cryptosuite
identifier (<var>cryptosuite</var>). A <em>proof configuration</em>
object is produced as output.
      </p>

      <ol class="algorithm">
        <li>
Let <var>proofConfig</var> be an empty object.
        </li>
        <li>
Set <var>proofConfig</var>.<var>type</var> to
<var>options</var>.<var>type</var>.
        </li>
        <li>
If <var>options</var>.<var>cryptosuite</var> is set, set
<var>proofConfig</var>.<var>cryptosuite</var> to its value.
        </li>
        <li>
If <var>options</var>.<var>type</var> is not set to <code>DataIntegrityProof</code> and
<var>proofConfig</var>.<var>cryptosuite</var> is not set to <code>bbs-2023</code>, an
<code>INVALID_PROOF_CONFIGURATION</code> error <em class="rfc2119">MUST</em> be raised.
        </li>
        <li>
Set <var>proofConfig</var>.<var>created</var> to
<var>options</var>.<var>created</var>. If the value is not a valid
[<cite><a class="bibref" data-link-type="biblio" href="#bib-xmlschema11-2" title="W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes">XMLSCHEMA11-2</a></cite>] datetime, an <code>INVALID_PROOF_DATETIME</code> error <em class="rfc2119">MUST</em> be raised.
        </li>
        <li>
Set <var>proofConfig</var>.<var>verificationMethod</var> to
<var>options</var>.<var>verificationMethod</var>.
        </li>
        <li>
Set <var>proofConfig</var>.<var>proofPurpose</var> to
<var>options</var>.<var>proofPurpose</var>.
        </li>
        <li>
Return <var>proofConfig</var>.
        </li>
      </ol>

    </section>

    <section id="proof-serialization-bbs-2023"><div class="header-wrapper"><h4 id="x3-1-6-proof-serialization-bbs-2023"><bdi class="secno">3.1.6 </bdi>Proof Serialization (bbs-2023)</h4><a class="self-link" href="#proof-serialization-bbs-2023" aria-label="Permalink for Section 3.1.6"></a></div>
      

      <p>
The following algorithm specifies how to serialize a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://w3c.github.io/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<var>hashData</var>) and
<em>proof options</em> (<var>options</var>). The
<em>proof options</em> <em class="rfc2119">MUST</em> contain a type identifier for the
<a href="https://w3c.github.io/vc-data-integrity/#dfn-cryptographic-suite">
cryptographic suite</a> (<var>type</var>) and <em class="rfc2119">MAY</em> contain a cryptosuite
identifier (<var>cryptosuite</var>). A single <em>digital proof</em> value
represented as series of bytes is produced as output.
      </p>

      <ol class="algorithm">
        <li>
Let <var>privateKeyBytes</var> be the result of retrieving the
private key bytes associated with the
<var>options</var>.<var>verificationMethod</var> value as described in the
Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://w3c.github.io/vc-data-integrity/#algorithms">
Section 4: Retrieving Cryptographic Material</a>.
        </li>
        <div class="issue" id="issue-container-number-8"><div role="heading" class="issue-title marker" id="h-issue-6" aria-level="5"><span>Issue 8</span></div><li class="">
Specify how <var>proofBytes</var> is generated and consumed by Section
<a href="#proof-verification-bbs-2023" class="sec-ref"><bdi class="secno">3.1.7 </bdi>Proof Verification (bbs-2023)</a>.
        </li></div>
        <li>
Return <var>proofBytes</var> as the <em>digital proof</em>.
        </li>
      </ol>

    </section>

    <section id="proof-verification-bbs-2023"><div class="header-wrapper"><h4 id="x3-1-7-proof-verification-bbs-2023"><bdi class="secno">3.1.7 </bdi>Proof Verification (bbs-2023)</h4><a class="self-link" href="#proof-verification-bbs-2023" aria-label="Permalink for Section 3.1.7"></a></div>
      

      <p>
The following algorithm specifies how to verify a digital signature from
a set of cryptographic hash data. This
algorithm is designed to be used in conjunction with the algorithms defined
in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://w3c.github.io/vc-data-integrity/#algorithms">
Section 4: Algorithms</a>. Required inputs are
cryptographic hash data (<var>hashData</var>),
a digital signature (<var>proofBytes</var>) and
proof options (<var>options</var>). A <em>verification result</em>
represented as a boolean value is produced as output.
      </p>

      <ol class="algorithm">
        <li>
Let <var>publicKeyBytes</var> be the result of retrieving the
public key bytes associated with the
<var>options</var>.<var>verificationMethod</var> value as described in the
Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-vc-data-integrity" title="Verifiable Credential Data Integrity 1.0">VC-DATA-INTEGRITY</a></cite>] specification,
<a href="https://w3c.github.io/vc-data-integrity/#algorithms">
Section 4: Retrieving Cryptographic Material</a>.
        </li>
        <li>
Let <var>verificationResult</var> be the result of applying the verification
algorithm defined in the BBS Signature specification [<cite><a class="bibref" data-link-type="biblio" href="#bib-cfrg-bbs-signature" title="The BBS Signature Scheme">CFRG-BBS-SIGNATURE</a></cite>],
with <var>hashData</var> as the data to be verified against the
<var>proofBytes</var> using the public key specified by
<var>publicKeyBytes</var>.
        </li>
        <li>
Return <var>verificationResult</var> as the <em>verification result</em>.
        </li>
      </ol>

    </section>
  </section>
</section>

    <section id="security-considerations"><div class="header-wrapper"><h2 id="x4-security-considerations"><bdi class="secno">4. </bdi>Security Considerations</h2><a class="self-link" href="#security-considerations" aria-label="Permalink for Section 4."></a></div>
      
      <p>
The following section describes security considerations that developers
implementing this specification should be aware of in order to create secure
software.
      </p>

<div class="issue" id="issue-container-number-9"><div role="heading" class="issue-title marker" id="h-issue-7" aria-level="3"><span>Issue 9</span></div><div class="">TODO: We need to add a complete list of security
considerations.</div></div>
    </section>

  <section class="appendix" id="bbs-signature-2020"><div class="header-wrapper"><h2 id="a-bbs-signature-2020"><bdi class="secno">A. </bdi>BBS+ Signature 2020</h2><a class="self-link" href="#bbs-signature-2020" aria-label="Permalink for Appendix A."></a></div>
    

    <section id="bls12-381"><div class="header-wrapper"><h3 id="a-1-bls12-381"><bdi class="secno">A.1 </bdi>BLS12-381</h3><a class="self-link" href="#bls12-381" aria-label="Permalink for Appendix A.1"></a></div>
      
      <p>
Defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-pairing-friendly-curves" title="Pairing-Friendly Curves">PAIRING-FRIENDLY-CURVES</a></cite>], BLS12-381 is an elliptic curve that features a unique property
only present in a subset of elliptic curves known as being pairing friendly.
      </p>
      <p>
Because of the pairing friendly property, BLS12-381 can be used to construct digital signatures
that have unique properties, such as aggregatable signatures and or signatures
that support zero knowledge proof disclosure.
      </p>


<div class="issue" id="issue-container-number-10"><div role="heading" class="issue-title marker" id="h-issue-8" aria-level="4"><span>Issue 10</span></div><div class="">TODO: Is the the below the correct place for the rationale?</div></div>

      <p>
With pairing friendly elliptic curves, there are two fields, denoted G1 and G2, for
which signatures and public keys can exist. Importantly however both the public
key and a signature generated using the public key cannot exist in the same field.
      </p>
      <p>
Due to the properties of the two fields, there are different associated performance
characteristics to selecting which field to use for signatures vs which field to use
for public key generation. In general operations are faster in G1 and the resulting commitments
are smaller. With this definition of BBS+ signatures we have opted for signatures to be faster
and smaller to create rather than key generation.
      </p>

  <section id="bls-12-381-g1-public-key"><div class="header-wrapper"><h4 id="a-1-1-bls-12-381-g1-public-key"><bdi class="secno">A.1.1 </bdi><dfn id="dfn-bls-12-381-g1-public-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Bls 12-381 G1 Public Key</dfn></h4><a class="self-link" href="#bls-12-381-g1-public-key" aria-label="Permalink for Appendix A.1.1"></a></div>
    

    <p>
      The following section defines the representation of the <dfn id="dfn-bls12381g1key2020" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Bls12381G1Key2020</dfn>
    </p>

    <p>
      The keys definition <em class="rfc2119">MUST</em> have an attribute of <code>publicKeyBase58</code> and its value
      <em class="rfc2119">MUST</em> be a base58 encoded BLS12-381 public key in the G1 field. Where the
      BLS12-381 public key is the raw 48 byte x co-ordinate defining the commitment.
    </p>
      <p>
      A simple example of a <a href="#dfn-bls12381g1key2020" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-bls12381g1key2020-1">Bls12381G1Key2020</a>:
      </p>
      <div class="example" id="example-base58-encoded-bls12-381-g1-key">
        <div class="marker">
    <a class="self-link" href="#example-base58-encoded-bls12-381-g1-key">Example<bdi> 6</bdi></a><span class="example-title">: base58 encoded BLS12-381 G1 Key</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:example:123#key-0"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Bls12381G1Key2020"</span>,
  <span class="hljs-attr">"controller"</span>: <span class="hljs-string">"did:example:123"</span>,
  <span class="hljs-attr">"publicKeyBase58"</span>: <span class="hljs-string">"7cJGQwV5XyzUjJEzY5doVhv62Qqou6qW7G4eh9YbUywgyeDCobiXjN8CnQ7wpWBrGR"</span>,
}</code></pre>
      </div>

      <div class="example" id="example-jwk-encoded-bls12-381-g1-key">
        <div class="marker">
    <a class="self-link" href="#example-jwk-encoded-bls12-381-g1-key">Example<bdi> 7</bdi></a><span class="example-title">: JWK encoded BLS12-381 G1 Key</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:example:123#key-0"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Bls12381G1Key2020"</span>,
  <span class="hljs-attr">"controller"</span>: <span class="hljs-string">"did:example:123"</span>,
  <span class="hljs-attr">"publicKeyJwk"</span>: {
    <span class="hljs-attr">"kty"</span>: <span class="hljs-string">"EC"</span>,
    <span class="hljs-attr">"crv"</span>: <span class="hljs-string">"BLS12381_G1"</span>,
    <span class="hljs-attr">"x"</span>: <span class="hljs-string">"tCgCNuUYQotPEsrljWi-lIRIPpzhqsnJV1NPnE7je6glUb-FJm9IYkuv2hbHw22i"</span>
  }
}</code></pre>
      </div>
  </section>

  <section id="bls-12-381-g2-public-key"><div class="header-wrapper"><h4 id="a-1-2-bls-12-381-g2-public-key"><bdi class="secno">A.1.2 </bdi><dfn id="dfn-bls-12-381-g2-public-key" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Bls 12-381 G2 Public Key</dfn></h4><a class="self-link" href="#bls-12-381-g2-public-key" aria-label="Permalink for Appendix A.1.2"></a></div>
    

    <p>
      The following section defines the representation of the <dfn id="dfn-bls12381g2key2020" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">Bls12381G2Key2020</dfn>
    </p>

    <p>
      The keys definition <em class="rfc2119">MUST</em> have an attribute of <code>publicKeyBase58</code> and its value
      <em class="rfc2119">MUST</em> be a base58 encoded BLS12-381 public key in the G2 field. Where the
      BLS12-381 public key is the concatenation of the 2 raw 48 byte x co-ordinates
      defining the commitment.
    </p>
      <p>
      A simple example of a <a href="#dfn-bls12381g2key2020" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-bls12381g2key2020-1">Bls12381G2Key2020</a>:
      </p>
      <div class="example" id="example-base58-encoded-bls12-381-g2-key">
        <div class="marker">
    <a class="self-link" href="#example-base58-encoded-bls12-381-g2-key">Example<bdi> 8</bdi></a><span class="example-title">: base58 encoded BLS12-381 G2 Key</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:example:123#key-1"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Bls12381G2Key2020"</span>,
  <span class="hljs-attr">"controller"</span>: <span class="hljs-string">"did:example:123"</span>,
  <span class="hljs-attr">"publicKeyBase58"</span> : <span class="hljs-string">"oqpWYKaZD9M1Kbe94BVXpr8WTdFBNZyKv48cziTiQUeuhm7sBhCABMyYG4kcMrseC68YTFFgyhiNeBKjzdKk9MiRWuLv5H4FFujQsQK2KTAtzU8qTBiZqBHMmnLF4PL7Ytu"</span>
}</code></pre>
      </div>

      <div class="example" id="example-jwk-encoded-bls12-381-g2-key">
        <div class="marker">
    <a class="self-link" href="#example-jwk-encoded-bls12-381-g2-key">Example<bdi> 9</bdi></a><span class="example-title">: JWK encoded BLS12-381 G2 Key</span>
  </div> <pre class="highlight" aria-busy="false"><code class="hljs json">{
  <span class="hljs-attr">"id"</span>: <span class="hljs-string">"did:example:123#key-1"</span>,
  <span class="hljs-attr">"type"</span>: <span class="hljs-string">"Bls12381G2Key2020"</span>,
  <span class="hljs-attr">"controller"</span>: <span class="hljs-string">"did:example:123"</span>,
  <span class="hljs-attr">"publicKeyJwk"</span>: {
    <span class="hljs-attr">"crv"</span>: <span class="hljs-string">"BLS12381_G2"</span>,
    <span class="hljs-attr">"kty"</span>: <span class="hljs-string">"EC"</span>,
    <span class="hljs-attr">"x"</span>: <span class="hljs-string">"h_rkcTKXXzRbOPr9UxSfegCbid2U_cVNXQUaKeGF7UhwrMJFP70uMH0VQ9-3-_2zDPAAjflsdeLkOXW3-ShktLxuPy8UlXSNgKNmkfb-rrj-FRwbs13pv_WsIf-eV66-"</span>
  }
}</code></pre>
      </div>
  </section>

    </section>


    <section id="the-bbs-signature-suite-2020"><div class="header-wrapper"><h3 id="a-2-the-bbs-signature-suite-2020"><bdi class="secno">A.2 </bdi>The BBS+ Signature Suite 2020</h3><a class="self-link" href="#the-bbs-signature-suite-2020" aria-label="Permalink for Appendix A.2"></a></div>
      

      <p>
        The BBS+ <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-2">signature suite</a> 2020 <em class="rfc2119">MUST</em> be used in
        conjunction with the signing and verification algorithms in the
        Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] specification. The suite consists of
        the following algorithms:
              </p>

              <table class="simple">
                <thead>
                  <tr><th>Parameter</th>
                  <th>Value</th>
                  <th>Specification</th>
                </tr></thead>
                <tbody>
                  <tr>
                    <td><a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-3">canonicalization algorithm</a></td>
                    <td>https://w3id.org/security#URDNA2015</td>
                    <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-normalization" title="RDF Dataset Normalization 1.0">RDF-DATASET-NORMALIZATION</a></cite>]</td>
                  </tr>
                  <tr>
                    <td><a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-3">statement digest algorithm</a></td>
                    <td>Blake2b</td>
                    <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-blake2" title="Blake2 - fast secure hashing">BLAKE2</a></cite>]</td>
                  </tr>
                  <tr>
                    <td><a href="#dfn-signature-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-algorithm-2">signature algorithm</a></td>
                    <td>BBS+ Signature</td>
                    <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-bbs" title="BBS+ Signatures">BBS</a></cite>]</td>
                  </tr>
                  <tr>
                    <td><a href="#dfn-curve-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-curve-name-1">curve name</a></td>
                    <td>BLS12-381</td>
                    <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pairing-friendly-curves" title="Pairing-Friendly Curves">PAIRING-FRIENDLY-CURVES</a></cite>]</td>
                  </tr>
                </tbody>
              </table>

      <section id="modification-to-algorithms"><div class="header-wrapper"><h4 id="a-2-1-modification-to-algorithms"><bdi class="secno">A.2.1 </bdi>Modification to Algorithms</h4><a class="self-link" href="#modification-to-algorithms" aria-label="Permalink for Appendix A.2.1"></a></div>
        

        <section id="create-verify-data-algorithm"><div class="header-wrapper"><h5 id="a-2-1-1-create-verify-data-algorithm"><bdi class="secno">A.2.1.1 </bdi>Create Verify Data Algorithm</h5><a class="self-link" href="#create-verify-data-algorithm" aria-label="Permalink for Appendix A.2.1.1"></a></div>
          

          <p>
            In order to support <a href="#dfn-selective-disclosure" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-selective-disclosure-1">selective disclosure</a> of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-5">statements</a>,
            the create verify data algorithm has been modified from
            its original <a href="https://w3c-ccg.github.io/data-integrity-spec/#create-verify-hash-algorithm"></a>definition.
          </p>

          <p>
          The algorithm defined below, outlines the process of obtaining the data in the form
          required for both signing and verifying.
          </p>

            <ol class="algorithm">
              <li>Canonicalize the input document using the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-4">canonicalization algorithm</a> to a set of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-6">statements</a> represented as <a href="#dfn-n-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-n-quad-2">n-quads</a>.</li>
              <li>Initialize an empty array of length equal to the number of statements, let this be known as the <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-1">statement digests</a> array.</li>
              <li>For each <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-7">statement</a> in order:
                <ol class="algorithm">
                  <li>Apply the <a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-4">statement digest algorithm</a> to obtain a <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-2">statement digest</a></li>
                  <li>Insert the <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-3">statement digest</a> into the <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-4">statement digests</a> array which <em class="rfc2119">MUST</em> maintain same order as the order
                    of the statements returned from the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-5">canonicalization algorithm</a>.</li>
                </ol>
              </li><li>Returned the <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-5">statement digests</a> array.</li>
            </ol>

        </section>

      </section>

      <section id="terms"><div class="header-wrapper"><h4 id="a-2-2-terms"><bdi class="secno">A.2.2 </bdi>Terms</h4><a class="self-link" href="#terms" aria-label="Permalink for Appendix A.2.2"></a></div>
        

        <p>
          The following section outlines the terms used by the BBS+ Signature Suite.
        </p>

        <section id="proof-type"><div class="header-wrapper"><h5 id="a-2-2-1-proof-type"><bdi class="secno">A.2.2.1 </bdi>Proof Type</h5><a class="self-link" href="#proof-type" aria-label="Permalink for Appendix A.2.2.1"></a></div>
          

          <p>
            To identify the type of <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-6">data integrity proof</a> that is attached to a <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-2">linked data document</a>,
            the <code>type</code> attribute <a href="https://w3c-ccg.github.io/data-integrity-spec/#proofs">defined</a> in
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>].
          </p>

          <p>
            The term of <code><dfn id="dfn-bbsblssignature2020" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">BbsBlsSignature2020</dfn></code> is used to indicate when a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-7">data integrity proof</a> is of type BBS+ Signature.
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-3">linked data document</a> featuring a BBS+ Signature <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-8">data integrity proof</a>
            <em class="rfc2119">MUST</em> contain a proof element thats has a type equal to <code>BbsBlsSignature2020</code>.
          </p>


          <div class="example" id="example-10">
        <div class="marker">
    <a class="self-link" href="#example-10">Example<bdi> 10</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    <span class="highlight">"type": "BbsBlsSignature2020"</span>,
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
    "requiredRevealStatements": [ 4, 5 ]
  }
}</pre>
      </div>
        </section>

        <section id="created"><div class="header-wrapper"><h5 id="a-2-2-2-created"><bdi class="secno">A.2.2.2 </bdi>Created</h5><a class="self-link" href="#created" aria-label="Permalink for Appendix A.2.2.2"></a></div>
          

          <p>
            When a digital signature is produced, it is often useful to capture when this occurred, the <code>created</code> attribute
            can be used to communicate this as <a href="https://w3c-ccg.github.io/data-integrity-spec/#proofs">defined</a> in
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>].
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-4">linked data document</a> featuring a BBS+ Signature <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-9">data integrity proof</a> <em class="rfc2119">MAY</em> contain a <code>created</code>
            attribute with value a value corresponding to an [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>] combined date and time string.
          </p>

          <div class="example" id="example-11">
        <div class="marker">
    <a class="self-link" href="#example-11">Example<bdi> 11</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    "type": "BbsBlsSignature2020",
    <span class="highlight">"created": "2020-04-25"</span>,
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
    "requiredRevealStatements": [ 4, 5 ]
  }
}</pre>
      </div>
        </section>

        <section id="context"><div class="header-wrapper"><h5 id="a-2-2-3-context"><bdi class="secno">A.2.2.3 </bdi>@context</h5><a class="self-link" href="#context" aria-label="Permalink for Appendix A.2.2.3"></a></div>
          

          <p>
            When using [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld" title="JSON-LD 1.1">JSON-LD</a></cite>] to exchange data between more than one software system, it's important to use terminology that both of the software systems can understand.
            In [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld" title="JSON-LD 1.1">JSON-LD</a></cite>] this common terminology is identified with the usage of URIs. However, those URIs can be long and not human friendly for implementors to work with.
            In such cases, aliases that are presented in a short-form can be used to ease this burden. This specification relies on the <code>@context</code> property in [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld" title="JSON-LD 1.1">JSON-LD</a></cite>]
            to short-form aliases to long form URIs required by this <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-3">signature suite</a>. It's <em class="rfc2119">RECOMMENDED</em> that <code>https://w3id.org/security/bbs/v1</code> is used within the
            <code>@context</code> property to map the short-form aliases to long form URIs.
          </p>

          <div class="example" id="example-12">
        <div class="marker">
    <a class="self-link" href="#example-12">Example<bdi> 12</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    <span class="highlight">"https://w3id.org/security/bbs/v1"</span>
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    "type": "BbsBlsSignature2020",
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
    "requiredRevealStatements": [ 4, 5 ]
  }
}</pre>
      </div>
        </section>

        <section id="verification-method"><div class="header-wrapper"><h5 id="a-2-2-4-verification-method"><bdi class="secno">A.2.2.4 </bdi>Verification Method</h5><a class="self-link" href="#verification-method" aria-label="Permalink for Appendix A.2.2.4"></a></div>
          

          <p>
            When verifying a digital signature, public key material of the signer is required, the <code>verificationMethod</code> attribute is
            used to communicate this as <a href="https://w3c-ccg.github.io/data-integrity-spec/#linked-data-proof-overview">defined</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>].
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-5">linked data document</a> featuring a BBS+ Signature <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-10">data integrity proof</a> <em class="rfc2119">MUST</em> contain a <code>verificationMethod</code>
            attribute with a value that is either the verification method required to verify the <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-11">data integrity proof</a> or a URI that when dereferenced
            results in the verification method required to verify the <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-12">data integrity proof</a>.
          </p>
          <p>
            The verification method <em class="rfc2119">MUST</em> be of <code>type</code> <a href="#dfn-bls12381g2key2020" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-bls12381g2key2020-2">Bls12381G2Key2020</a>.
          </p>


          <div class="example" id="example-13">
        <div class="marker">
    <a class="self-link" href="#example-13">Example<bdi> 13</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    "type": "BbsBlsSignature2020",
    "created": "2020-04-25",
    <span class="highlight">"verificationMethod": "did:example:489398593#test"</span>,
    "proofPurpose": "assertionMethod",
    "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
    "requiredRevealStatements": [ 4, 5 ]
  }
}</pre>
      </div>
        </section>

        <section id="proof-purpose"><div class="header-wrapper"><h5 id="a-2-2-5-proof-purpose"><bdi class="secno">A.2.2.5 </bdi>Proof Purpose</h5><a class="self-link" href="#proof-purpose" aria-label="Permalink for Appendix A.2.2.5"></a></div>
          

          <p>
            A proof purpose defines what the purpose of the created proof was and is used to detect whether the verification method
            has been used correctly.
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-6">linked data document</a> featuring a BBS+ Signature <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-13">data integrity proof</a> <em class="rfc2119">MUST</em> contain a <code>proofPurpose</code>
            attribute with a value that is <a href="https://w3c-ccg.github.io/data-integrity-spec/#proof-purpose">defined</a> in [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>].
          </p>

          <div class="example" id="example-14">
        <div class="marker">
    <a class="self-link" href="#example-14">Example<bdi> 14</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    "type": "BbsBlsSignature2020",
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    <span class="highlight">"proofPurpose": "assertionMethod"</span>,
    "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
    "requiredRevealStatements": [ 4, 5 ]
  }
}</pre>
      </div>
        </section>

        <section id="required-reveal-statements"><div class="header-wrapper"><h5 id="a-2-2-6-required-reveal-statements"><bdi class="secno">A.2.2.6 </bdi>Required Reveal Statements</h5><a class="self-link" href="#required-reveal-statements" aria-label="Permalink for Appendix A.2.2.6"></a></div>
          

          <p>
            When producing a digital signature that is capable of <a href="#dfn-selective-disclosure" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-selective-disclosure-2">selective disclosure</a> with a set signed statements, it is useful for the
            signer to be able to express as apart of the proof which statements must be revealed in a <a href="#dfn-derived-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-derived-proof-1">derived proof</a>
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-7">linked data document</a> featuring a BBS+ Signature <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-14">data integrity proof</a> <em class="rfc2119">MUST</em> contain a <code>requiredRevealStatements</code>
            attribute with a value that is an array of un-signed integers representing the indicies of the statements in the <a href="#dfn-canonical-form" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonical-form-2">canonical form</a>
            that <em class="rfc2119">MUST</em> always be revealed in a <a href="#dfn-derived-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-derived-proof-2">derived proof</a>. The indicies corresponding to the statements for the <code>verificationMethod</code>
            and <code>proofPurpose</code> as apart of the <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-15">data integrity proof</a> <em class="rfc2119">MUST</em> always be present.
          </p>


          <div class="example" id="example-15">
        <div class="marker">
    <a class="self-link" href="#example-15">Example<bdi> 15</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    "type": "BbsBlsSignature2020",
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg==",
    <span class="highlight">"requiredRevealStatements": [ 4, 5 ]</span>
  }
}</pre>
      </div>
        </section>

        <section id="proof-value"><div class="header-wrapper"><h5 id="a-2-2-7-proof-value"><bdi class="secno">A.2.2.7 </bdi>Proof Value</h5><a class="self-link" href="#proof-value" aria-label="Permalink for Appendix A.2.2.7"></a></div>
          

          <p>
            The raw value outputted by computing a sign operation must feature in the proof, in order for parties to verify the signature.
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-8">linked data document</a> featuring a BBS+ Signature <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-16">data integrity proof</a> <em class="rfc2119">MUST</em> contain a <code>proofValue</code>
            attribute with value defined by the signing algorithm described in this specification.
          </p>

          <div class="issue" id="issue-container-number-11"><div role="heading" class="issue-title marker" id="h-issue-9" aria-level="6"><span>Issue 11</span></div><div class="">TODO: Define the encoding scheme for the signature value</div></div>

          <div class="example" id="example-16">
        <div class="marker">
    <a class="self-link" href="#example-16">Example<bdi> 16</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    "type": "BbsBlsSignature2020",
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    <span class="highlight">"proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg=="</span>,
    "requiredRevealStatements": [ 4, 5 ]
  }
}</pre>
      </div>
        </section>
      </section>
    </section>

    <section id="the-bbs-signature-proof-suite-2020"><div class="header-wrapper"><h3 id="a-3-the-bbs-signature-proof-suite-2020"><bdi class="secno">A.3 </bdi>The BBS+ Signature Proof Suite 2020</h3><a class="self-link" href="#the-bbs-signature-proof-suite-2020" aria-label="Permalink for Appendix A.3"></a></div>
      
      <p>
A BBS proof of knowledge <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-17">data integrity proof</a> is a proof that
is derived from a <a href="#dfn-bbsblssignature2020" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-bbsblssignature2020-1"><code>BbsBlsSignature2020</code></a> <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-18">data integrity proof</a>
where by a sub-set of the original <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-8">statements</a> are revealed.
      </p>
      <p>
The BBS+ proof of knowledge <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-4">signature suite</a> <em class="rfc2119">MUST</em> be used in
conjunction with the signing and verification algorithms in the
Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] specification. The suite consists of
the following algorithms:
      </p>
      <table class="simple">
        <thead>
          <tr><th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </tr></thead>
        <tbody>
          <tr>
            <td><a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-6">canonicalization algorithm</a></td>
            <td>https://w3id.org/security#URDNA2015</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-normalization" title="RDF Dataset Normalization 1.0">RDF-DATASET-NORMALIZATION</a></cite>]</td>
          </tr>
          <tr>
            <td><a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-5">statement digest algorithm</a></td>
            <td>Blake2b</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-blake2" title="Blake2 - fast secure hashing">BLAKE2</a></cite>]</td>
          </tr>
          <tr>
            <td><a href="#dfn-signature-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-algorithm-3">signature algorithm</a></td>
            <td>BBS+ Signature</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-bbs" title="BBS+ Signatures">BBS</a></cite>]</td>
          </tr>
          <tr>
            <td><a href="#dfn-curve-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-curve-name-2">curve name</a></td>
            <td>BLS12-381</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pairing-friendly-curves" title="Pairing-Friendly Curves">PAIRING-FRIENDLY-CURVES</a></cite>]</td>
          </tr>
        </tbody>
      </table>

      <section id="terms-0"><div class="header-wrapper"><h4 id="a-3-1-terms"><bdi class="secno">A.3.1 </bdi>Terms</h4><a class="self-link" href="#terms-0" aria-label="Permalink for Appendix A.3.1"></a></div>
        

        <p>
          The following section outlines the terms used by the BBS+ proof of knowledge <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-5">signature suite</a>.
        </p>

        <section id="proof-type-0"><div class="header-wrapper"><h5 id="a-3-1-1-proof-type"><bdi class="secno">A.3.1.1 </bdi>Proof Type</h5><a class="self-link" href="#proof-type-0" aria-label="Permalink for Appendix A.3.1.1"></a></div>
          

          <p>
            To identify the type of <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-19">data integrity proof</a> that is attached to a <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-9">linked data document</a>,
            the <code>type</code> attribute is used as <a href="https://w3c-ccg.github.io/data-integrity-spec/#proofs">defined</a> in
            [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>].
          </p>

          <p>
            The term of <code>BbsSignatureProof2020</code> is used to indicate when a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-20">data integrity proof</a> is of type BBS+ proof of knowledge.
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-10">linked data document</a> featuring a BBS+ proof of knowledge <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-21">data integrity proof</a>
            <em class="rfc2119">MUST</em> contain a <code>type</code> attribute thats has a type equal to <code>BbsSignatureProof2020</code>.
          </p>

          <div class="example" id="example-17">
        <div class="marker">
    <a class="self-link" href="#example-17">Example<bdi> 17</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "id": "urn:bnid:_:c14n0",
  "email": "jane.doe@example.com",
  "firstName": "Jane",
  "jobTitle": "Professor",
  "lastName": "Does",
  "telephone": "(425) 123-4567",
  "proof": {
    <span class="highlight">"type": "BbsBlsSignatureProof2020"</span>,
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
    "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
  }
}</pre>
      </div>
        </section>

        <section id="created-0"><div class="header-wrapper"><h5 id="a-3-1-2-created"><bdi class="secno">A.3.1.2 </bdi>Created</h5><a class="self-link" href="#created-0" aria-label="Permalink for Appendix A.3.1.2"></a></div>
          

          <div class="issue" id="issue-container-number-12"><div role="heading" class="issue-title marker" id="h-issue-10" aria-level="6"><span>Issue 12</span></div><div class="">TODO: Add paragraph?</div></div>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-11">linked data document</a> featuring a BBS+ Signature <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-22">data integrity proof</a> <em class="rfc2119">MAY</em> contain a <code>created</code>
            attribute with value a value corresponding to an [<cite><a class="bibref" data-link-type="biblio" href="#bib-iso8601" title="Representation of dates and times. ISO 8601:2004.">ISO8601</a></cite>] combined date and time string.
          </p>

          <div class="example" id="example-18">
        <div class="marker">
    <a class="self-link" href="#example-18">Example<bdi> 18</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "id": "urn:bnid:_:c14n0",
  "email": "jane.doe@example.com",
  "firstName": "Jane",
  "jobTitle": "Professor",
  "lastName": "Does",
  "telephone": "(425) 123-4567",
  "proof": {
    "type": "BbsBlsSignatureProof2020",
    <span class="highlight">"created": "2020-04-25"</span>,
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
    "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
  }
}</pre>
      </div>
        </section>

        <section id="verification-method-0"><div class="header-wrapper"><h5 id="a-3-1-3-verification-method"><bdi class="secno">A.3.1.3 </bdi>Verification Method</h5><a class="self-link" href="#verification-method-0" aria-label="Permalink for Appendix A.3.1.3"></a></div>
          

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-12">linked data document</a> featuring a BBS+ proof of knowledge <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-23">data integrity proof</a> <em class="rfc2119">MUST</em> contain a <code>verificationMethod</code>
            attribute with a value that is equal to that of the <a href="#dfn-bbsblssignature2020" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-bbsblssignature2020-2"><code>BbsBlsSignature2020</code></a> for which the proof is derived from.
          </p>

          <div class="issue" id="issue-container-number-13"><div role="heading" class="issue-title marker" id="h-issue-11" aria-level="6"><span>Issue 13</span></div><div class="">TODO: Add paragraph?</div></div>

          <div class="example" id="example-19">
        <div class="marker">
    <a class="self-link" href="#example-19">Example<bdi> 19</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "id": "urn:bnid:_:c14n0",
  "email": "jane.doe@example.com",
  "firstName": "Jane",
  "jobTitle": "Professor",
  "lastName": "Does",
  "telephone": "(425) 123-4567",
  "proof": {
    "type": "BbsBlsSignatureProof2020",
    "created": "2020-04-25",
    <span class="highlight">"verificationMethod": "did:example:489398593#test"</span>,
    "proofPurpose": "assertionMethod",
    "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
    "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
  }
}</pre>
      </div>
        </section>

        <section id="proof-purpose-0"><div class="header-wrapper"><h5 id="a-3-1-4-proof-purpose"><bdi class="secno">A.3.1.4 </bdi>Proof Purpose</h5><a class="self-link" href="#proof-purpose-0" aria-label="Permalink for Appendix A.3.1.4"></a></div>
          

          <div class="issue" id="issue-container-number-14"><div role="heading" class="issue-title marker" id="h-issue-12" aria-level="6"><span>Issue 14</span></div><div class="">TODO: Add paragraph?</div></div>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-13">linked data document</a> featuring a BBS+ proof of knowledge <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-24">data integrity proof</a> <em class="rfc2119">MUST</em> contain a <code>proofPurpose</code>
            attribute with a value that is equal to that of the <a href="#dfn-bbsblssignature2020" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-bbsblssignature2020-3"><code>BbsBlsSignature2020</code></a> for which the proof is derived from.
          </p>

          <div class="example" id="example-20">
        <div class="marker">
    <a class="self-link" href="#example-20">Example<bdi> 20</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "id": "urn:bnid:_:c14n0",
  "email": "jane.doe@example.com",
  "firstName": "Jane",
  "jobTitle": "Professor",
  "lastName": "Does",
  "telephone": "(425) 123-4567",
  "proof": {
    "type": "BbsBlsSignatureProof2020",
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    <span class="highlight">"proofPurpose": "assertionMethod"</span>,
    "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
    "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
  }
}</pre>
      </div>
        </section>

        <section id="proof-value-0"><div class="header-wrapper"><h5 id="a-3-1-5-proof-value"><bdi class="secno">A.3.1.5 </bdi>Proof Value</h5><a class="self-link" href="#proof-value-0" aria-label="Permalink for Appendix A.3.1.5"></a></div>
          

          <p>
            The raw value outputted by computing a derive proof operation must feature in the proof, in order for parties to be able to verify the proof.
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-14">linked data document</a> featuring a BBS+ proof of knowledge <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-25">data integrity proof</a>
            <em class="rfc2119">MUST</em> contain a <code>proofValue</code> attribute with value defined by the derive proof algorithm
            described in this specification.
          </p>


          <div class="example" id="example-21">
        <div class="marker">
    <a class="self-link" href="#example-21">Example<bdi> 21</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "id": "urn:bnid:_:c14n0",
  "email": "jane.doe@example.com",
  "firstName": "Jane",
  "jobTitle": "Professor",
  "lastName": "Does",
  "telephone": "(425) 123-4567",
  "proof": {
    "type": "BbsBlsSignatureProof2020",
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    <span class="highlight">"proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg="</span>,
    "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
  }
}</pre>
      </div>
        </section>

        <section id="nonce"><div class="header-wrapper"><h5 id="a-3-1-6-nonce"><bdi class="secno">A.3.1.6 </bdi>Nonce</h5><a class="self-link" href="#nonce" aria-label="Permalink for Appendix A.3.1.6"></a></div>
          

          <p>
            When a proof is derived it is often useful to prove to the audience of the proof
            the uniqueness or freshness of proof, the nonce attribute can be used to communicate this.
          </p>

          <p>
            A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-15">linked data document</a> featuring a BBS+ proof of knowledge <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-26">data integrity proof</a>
            <em class="rfc2119">MUST</em> contain a <code>nonce</code> attribute.
          </p>

          <div class="example" id="example-22">
        <div class="marker">
    <a class="self-link" href="#example-22">Example<bdi> 22</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "id": "urn:bnid:_:c14n0",
  "email": "jane.doe@example.com",
  "firstName": "Jane",
  "jobTitle": "Professor",
  "lastName": "Does",
  "telephone": "(425) 123-4567",
  "proof": {
    "type": "BbsBlsSignatureProof2020",
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proof": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
    <span class="highlight">"nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="</span>
  }
}</pre>
      </div>
        </section>
      </section>
    </section>

    <section id="the-bbs-bound-signature-suite-2020"><div class="header-wrapper"><h3 id="a-4-the-bbs-bound-signature-suite-2020"><bdi class="secno">A.4 </bdi>The BBS+ Bound Signature Suite 2020</h3><a class="self-link" href="#the-bbs-bound-signature-suite-2020" aria-label="Permalink for Appendix A.4"></a></div>
      

      <p>
The BBS+ Bound <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-6">signature suite</a> 2020 adds a mechanism for recipient
binding, and is otherwise identical, to the BBS+ <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-7">signature suite</a>
2020. It <em class="rfc2119">MUST</em> be used in conjunction with the signing and verification
algorithms in the Data Integrity [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] specification. The suite
consists of the following algorithms:
      </p>
      <table class="simple">
        <thead>
        <tr><th>Parameter</th>
        <th>Value</th>
        <th>Specification</th>
        </tr></thead>
        <tbody>
        <tr>
          <td><a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-7">canonicalization algorithm</a></td>
          <td>https://w3id.org/security#URDNA2015</td>
          <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-normalization" title="RDF Dataset Normalization 1.0">RDF-DATASET-NORMALIZATION</a></cite>]</td>
        </tr>
        <tr>
          <td><a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-6">statement digest algorithm</a></td>
          <td>Blake2b</td>
          <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-blake2" title="Blake2 - fast secure hashing">BLAKE2</a></cite>]</td>
        </tr>
        <tr>
          <td><a href="#dfn-signature-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-algorithm-4">signature algorithm</a></td>
          <td>BBS+ Signature</td>
          <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-bbs" title="BBS+ Signatures">BBS</a></cite>]</td>
        </tr>
        <tr>
          <td><a href="#dfn-curve-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-curve-name-3">curve name</a></td>
          <td>BLS12-381</td>
          <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pairing-friendly-curves" title="Pairing-Friendly Curves">PAIRING-FRIENDLY-CURVES</a></cite>]</td>
        </tr>
        </tbody>
      </table>

      <section id="modification-to-algorithms-0"><div class="header-wrapper"><h4 id="a-4-1-modification-to-algorithms"><bdi class="secno">A.4.1 </bdi>Modification to Algorithms</h4><a class="self-link" href="#modification-to-algorithms-0" aria-label="Permalink for Appendix A.4.1"></a></div>
        

        <section id="create-verify-data-algorithm-0"><div class="header-wrapper"><h5 id="a-4-1-1-create-verify-data-algorithm"><bdi class="secno">A.4.1.1 </bdi>Create Verify Data Algorithm</h5><a class="self-link" href="#create-verify-data-algorithm-0" aria-label="Permalink for Appendix A.4.1.1"></a></div>
          

          <p>
The create verify data algorithm defined below is identical to the create verify
data algorithm defined for the BBS+ <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-8">signature suite</a> 2020, with the
addition of steps to include recipient binding.
          </p>

          <p>
The algorithm defined below outlines the process of obtaining the data in the
form required for both signing and verifying, plus the data required to bind to
a recipient
          </p>
          <ol class="algorithm">
            <li>
Obtain a blind message which is a commitment to a secret value as described in
[<cite><a class="bibref" data-link-type="biblio" href="#bib-bbs" title="BBS+ Signatures">BBS</a></cite>] section 3.9. This is the recipient binding commitment.
            </li>
            <li>
Initialize an empty array of length equal to the number of statements not
including the recipient binding commitment; let this be known as the
<a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-6">statement digests</a> array.
            </li>
            <li>
Use the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-8">canonicalization algorithm</a> to canonicalize the input document to a
set of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-9">statements</a> represented as <a href="#dfn-n-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-n-quad-3">n-quads</a>.
            </li>
            <li>
For each <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-10">statement</a> in order:
              <ol class="algorithm">
                <li>
Apply the <a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-7">statement digest algorithm</a> to obtain a <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-7">statement digest</a>
                </li>
                <li>
Insert the <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-8">statement digest</a> into the <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-9">statement digests</a> array which
<em class="rfc2119">MUST</em> maintain same order as the order of the statements returned from the
<a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-9">canonicalization algorithm</a>.
                </li>
              </ol>
            </li>
            <li>
Return the <a href="#dfn-statement-digest" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-10">statement digests</a> array and the recipient binding commitment.
            </li>
          </ol>

        </section>

      </section>

      <section id="terms-1"><div class="header-wrapper"><h4 id="a-4-2-terms"><bdi class="secno">A.4.2 </bdi>Terms</h4><a class="self-link" href="#terms-1" aria-label="Permalink for Appendix A.4.2"></a></div>
        

        <p>
The following section outlines the terms used by the BBS+ Bound Signature Suite
which differ from those terms used by the BBS+ Signature Suite. All other terms
are the same in both suites.
        </p>

        <section id="proof-type-1"><div class="header-wrapper"><h5 id="a-4-2-1-proof-type"><bdi class="secno">A.4.2.1 </bdi>Proof Type</h5><a class="self-link" href="#proof-type-1" aria-label="Permalink for Appendix A.4.2.1"></a></div>
          

          <p>
Use the <code>type</code> attribute
<a href="https://w3c-ccg.github.io/data-integrity-spec/#proofs">defined</a>
in [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] to identify the type of <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-27">data integrity proof</a> that is attached
to a <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-16">linked data document</a>.
          </p>

          <p>
The term <code><dfn id="dfn-bbsblsboundsignature2020" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">BbsBlsBoundSignature2020</dfn></code> is used to indicate
when a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-28">data integrity proof</a> is of type BBS+ Bound Signature.
          </p>

          <p>
A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-17">linked data document</a> featuring a BBS+ Bound Signature
<a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-29">data integrity proof</a> <em class="rfc2119">MUST</em> contain a proof element that has a type equal to
<code>BbsBlsBoundSignature2020</code>.
          </p>

          <div class="example" id="example-23">
        <div class="marker">
    <a class="self-link" href="#example-23">Example<bdi> 23</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "@type": "Person",
  "firstName": "Jane",
  "lastName": "Does",
  "jobTitle": "Professor",
  "telephone": "(425) 123-4567",
  "email": "jane.doe@example.com",
  "proof": {
    <span class="highlight">"type": "BbsBlsBoundSignature2020"</span>,
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "F9uMuJzNBqj4j+HPTvWjUN/MNoe6KRH0818WkvDn2Sf7kg1P17YpNyzSB+CH57AWDFunU13tL8oTBDpBhODckelTxHIaEfG0rNmqmjK6DOs0/ObksTZh7W3OTbqfD2h4C/wqqMQHSWdXXnojwyFDEg=="
  }
}</pre>
      </div>
        </section>
      </section>
    </section>

    <section id="the-bbs-bound-signature-proof-suite-2020"><div class="header-wrapper"><h3 id="a-5-the-bbs-bound-signature-proof-suite-2020"><bdi class="secno">A.5 </bdi>The BBS+ Bound Signature Proof Suite 2020</h3><a class="self-link" href="#the-bbs-bound-signature-proof-suite-2020" aria-label="Permalink for Appendix A.5"></a></div>
      
      <p>
A BBS bound proof of knowledge <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-30">data integrity proof</a> is a proof that is
derived from a <a href="#dfn-bbsblsboundsignature2020" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-bbsblsboundsignature2020-1"><code>BbsBlsBoundSignature2020</code></a> <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-31">data integrity proof</a> where
a sub-set of the original <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-11">statements</a> are revealed.
      </p>
      <p>
The BBS+ bound proof of knowledge <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-9">signature suite</a> <em class="rfc2119">MUST</em> be used in
conjunction with the signing and verification algorithms in the Linked Data
Proofs [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>] specification. It adds a proof of recipient binding,
and is otherwise identical, to the BBS+ proof of knowledge <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-10">signature
suite</a>. The suite consists of the following algorithms:
      </p>
      <table class="simple">
        <thead>
          <tr><th>Parameter</th>
          <th>Value</th>
          <th>Specification</th>
        </tr></thead>
        <tbody>
          <tr>
            <td><a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-10">canonicalization algorithm</a></td>
            <td>https://w3id.org/security#URDNA2015</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-rdf-dataset-normalization" title="RDF Dataset Normalization 1.0">RDF-DATASET-NORMALIZATION</a></cite>]</td>
          </tr>
          <tr>
            <td><a href="#dfn-statement-digest-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-digest-algorithm-8">statement digest algorithm</a></td>
            <td>Blake2b</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-blake2" title="Blake2 - fast secure hashing">BLAKE2</a></cite>]</td>
          </tr>
          <tr>
            <td><a href="#dfn-signature-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-algorithm-5">signature algorithm</a></td>
            <td>BBS+ Signature</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-bbs" title="BBS+ Signatures">BBS</a></cite>]</td>
          </tr>
          <tr>
            <td><a href="#dfn-curve-name" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-curve-name-4">curve name</a></td>
            <td>BLS12-381</td>
            <td>[<cite><a class="bibref" data-link-type="biblio" href="#bib-pairing-friendly-curves" title="Pairing-Friendly Curves">PAIRING-FRIENDLY-CURVES</a></cite>]</td>
          </tr>
        </tbody>
      </table>

      <section id="terms-2"><div class="header-wrapper"><h4 id="a-5-1-terms"><bdi class="secno">A.5.1 </bdi>Terms</h4><a class="self-link" href="#terms-2" aria-label="Permalink for Appendix A.5.1"></a></div>
        

        <p>
The following section outlines the terms used by the BBS+ bound proof of
knowledge <a href="#dfn-signature-suite" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-signature-suite-11">signature suite</a> which differ from those terms used by the BBS+
proof of knowledge. All other terms are the same in both suites.

        </p>

        <section id="proof-type-2"><div class="header-wrapper"><h5 id="a-5-1-1-proof-type"><bdi class="secno">A.5.1.1 </bdi>Proof Type</h5><a class="self-link" href="#proof-type-2" aria-label="Permalink for Appendix A.5.1.1"></a></div>
          

          <p>
The <code>type</code> attribute is used to identify the type of <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-32">data
integrity proof</a> that is attached to a <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-18">linked data document</a> as <a href="https://w3c-ccg.github.io/data-integrity-spec/#proofs">defined</a>
in [<cite><a class="bibref" data-link-type="biblio" href="#bib-data-integrity" title="Data Integrity 1.0">DATA-INTEGRITY</a></cite>].
          </p>

          <p>
The term <code>BbsBoundSignatureProof2020</code> is used to indicate when a
<a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-33">data integrity proof</a> is of type BBS+ bound proof of knowledge.
          </p>

          <p>
A <a href="#dfn-linked-data-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-linked-data-document-19">linked data document</a> featuring a BBS+ bound proof of knowledge
<a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-34">data integrity proof</a> <em class="rfc2119">MUST</em> contain a <code>type</code> attribute with a
value of <code>BbsBoundSignatureProof2020</code>.
          </p>

          <div class="example" id="example-24">
        <div class="marker">
    <a class="self-link" href="#example-24">Example<bdi> 24</bdi></a>
  </div> <pre class="nohighlight">{
  "@context": [
    "http://schema.org/",
    "https://w3id.org/security/v2",
    "https://w3id.org/security/bbs/v1"
  ],
  "id": "urn:bnid:_:c14n0",
  "email": "jane.doe@example.com",
  "firstName": "Jane",
  "jobTitle": "Professor",
  "lastName": "Does",
  "telephone": "(425) 123-4567",
  "proof": {
    <span class="highlight">"type": "BbsBlsBoundSignatureProof2020"</span>,
    "created": "2020-04-25",
    "verificationMethod": "did:example:489398593#test",
    "proofPurpose": "assertionMethod",
    "proofValue": "kTTbA3pmDa6Qia/JkOnIXDLmoBz3vsi7L5t3DWySI/VLmBqleJ/Tbus5RoyiDERDBEh5rnACXlnOqJ/U8yFQFtcp/mBCc2FtKNPHae9jKIv1dm9K9QK1F3GI1AwyGoUfjLWrkGDObO1ouNAhpEd0+et+qiOf2j8p3MTTtRRx4Hgjcl0jXCq7C7R5/nLpgimHAAAAdAx4ouhMk7v9dXijCIMaG0deicn6fLoq3GcNHuH5X1j22LU/hDu7vvPnk/6JLkZ1xQAAAAIPd1tu598L/K3NSy0zOy6obaojEnaqc1R5Ih/6ZZgfEln2a6tuUp4wePExI1DGHqwj3j2lKg31a/6bSs7SMecHBQdgIYHnBmCYGNQnu/LZ9TFV56tBXY6YOWZgFzgLDrApnrFpixEACM9rwrJ5ORtxAAAAAgE4gUIIC9aHyJNa5TBklMOh6lvQkMVLXa/vEl+3NCLXblxjgpM7UEMqBkE9/QcoD3Tgmy+z0hN+4eky1RnJsEg=",
    "nonce": "6i3dTz5yFfWJ8zgsamuyZa4yAHPm75tUOOXddR6krCvCYk77sbCOuEVcdBCDd/l6tIY="
  }
}</pre>
      </div>
        </section>
      </section>
    </section>

    <section id="derive-proof-algorithm"><div class="header-wrapper"><h3 id="a-6-derive-proof-algorithm"><bdi class="secno">A.6 </bdi>Derive Proof Algorithm</h3><a class="self-link" href="#derive-proof-algorithm" aria-label="Permalink for Appendix A.6"></a></div>
      

      <p>
        In order to support <a href="#dfn-selective-disclosure" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-selective-disclosure-3">selective disclosure</a> of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-12">statements</a>,
        the following <a href="#dfn-derive-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-derive-proof-algorithm-3">derive proof algorithm</a> has been defined.
      </p>

      <div class="issue" id="issue-container-number-15"><div role="heading" class="issue-title marker" id="h-issue-13" aria-level="4"><span>Issue 15</span></div><div class="">TODO: Add examples and full definition of this algorithm</div></div>

      <section id="create-derive-proof-data-algorithm"><div class="header-wrapper"><h4 id="a-6-1-create-derive-proof-data-algorithm"><bdi class="secno">A.6.1 </bdi>Create Derive Proof Data Algorithm</h4><a class="self-link" href="#create-derive-proof-data-algorithm" aria-label="Permalink for Appendix A.6.1"></a></div>
        

        <p>
          The following algorithm defined below outlines the process of obtaining the inputs into the <a href="#dfn-derive-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-derive-proof-algorithm-4">derive proof algorithm</a>.
        </p>

        <dt><dfn id="dfn-input-proof-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">input proof document</dfn></dt>
            <dd>
      A <a href="#dfn-data-integrity-proof-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-document-3">data integrity proof document</a> featuring a <a href="#dfn-data-integrity-proof" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-35">data integrity proof</a> that supports proof derivation.
            </dd>

        <dt><dfn id="dfn-reveal-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">reveal document</dfn></dt>
            <dd>
      A <a href="#dfn-json-ld-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-json-ld-document-2">JSON-LD document</a> in the form of a <a href="#dfn-frame" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-frame-2">frame</a> which describes the desired transform to apply to the <a href="#dfn-input-proof-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-proof-document-1">input proof document</a> using
      the <a href="#dfn-framing-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-framing-algorithm-1">framing algorithm</a> defined in [<cite><a class="bibref" data-link-type="biblio" href="#bib-json-ld-framing" title="JSON-LD 1.1 Framing">JSON-LD-FRAMING</a></cite>].
            </dd>

        <dt><dfn id="dfn-revealed-document" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">revealed document</dfn></dt>
            <dd>
      A <a href="#dfn-data-integrity-proof-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-data-integrity-proof-document-4">data integrity proof document</a> which is the product of the <a href="#dfn-derive-proof-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-derive-proof-algorithm-5">derive proof algorithm</a>.
            </dd>

          <ol class="algorithm">
            <li>
              Apply the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-11">canonicalization algorithm</a> to the <a href="#dfn-input-proof-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-proof-document-2">input proof document</a> to obtain a set of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-13">statements</a>
              represented as <a href="#dfn-n-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-n-quad-4">n-quads</a>. Let this set be known as the <dfn id="dfn-input-proof-document-statements" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">input proof document statements</dfn>.
            </li>
            <li>
              Record the total number of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-14">statements</a> in the <a href="#dfn-input-proof-document-statements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-proof-document-statements-1">input proof document statements</a>.
              Let this be known as the <dfn id="dfn-total-statements" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">total statements</dfn>.
            </li>
            <li>
              Apply the <a href="#dfn-framing-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-framing-algorithm-2">framing algorithm</a> to the <a href="#dfn-input-proof-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-proof-document-3">input proof document</a>. Let the product of the <a href="#dfn-framing-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-framing-algorithm-3">framing algorithm</a> be
              known as the <a href="#dfn-revealed-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-revealed-document-1">revealed document</a>.
            </li>
            <li>
              Canonicalize the <a href="#dfn-revealed-document" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-revealed-document-2">revealed document</a> using the <a href="#dfn-canonicalization-algorithm" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-canonicalization-algorithm-12">canonicalization algorithm</a> to obtain the set of <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-15">statements</a>
              represented as <a href="#dfn-n-quad" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-n-quad-5">n-quads</a>. Let these be known as the <a href="#dfn-revealed-statements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-revealed-statements-1">revealed statements</a>.
            </li>
            <li>
              Initialize an empty array of length equal to the number of <a href="#dfn-revealed-statements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-revealed-statements-2">revealed statements</a>.
              Let this be known as the <dfn id="dfn-revealed-indicies" tabindex="0" aria-haspopup="dialog" data-dfn-type="dfn">revealed indicies</dfn> array.
            </li>
            <li>For each <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-16">statement</a> in order:
              <ol class="algorithm">
                <li>Find the numerical index the <a href="#dfn-statement" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-statement-17">statement</a> occupies in the set <a href="#dfn-input-proof-document-statements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-proof-document-statements-2">input proof document statements</a>.
                </li><li>Insert this numerical index into the <a href="#dfn-revealed-indicies" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-revealed-indicies-1">revealed indicies</a> array</li>
              </ol>
            </li><li>Returned the <a href="#dfn-revealed-indicies" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-revealed-indicies-2">revealed indicies</a> array, <a href="#dfn-total-statements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-total-statements-1">total statements</a> and <a href="#dfn-input-proof-document-statements" class="internalDFN" data-link-type="dfn" id="ref-for-dfn-input-proof-document-statements-3">input proof document statements</a>.</li>
          </ol>
          <div class="issue" id="issue-container-number-16"><div role="heading" class="issue-title marker" id="h-issue-14" aria-level="5"><span>Issue 16</span></div><div class="">TODO: Define how we have to validate the requiredRevealStatements</div></div>

          <div class="issue" id="issue-container-number-17"><div role="heading" class="issue-title marker" id="h-issue-15" aria-level="5"><span>Issue 17</span></div><div class="">TODO: Add a comment on how we diff the input proof document and the reveal
            document to produce get the correct node identifiers for the reveal document</div></div>
      </section>

    </section>

    </section>

    <section class="appendix" id="acknowledgements"><div class="header-wrapper"><h2 id="b-acknowledgements"><bdi class="secno">B. </bdi>Acknowledgements</h2><a class="self-link" href="#acknowledgements" aria-label="Permalink for Appendix B."></a></div>
      
      <p>
        Portions of the work on this specification have been funded by the
        United States Department of Homeland Security's (US DHS) Silicon Valley
        Innovation Program under contracts
        70RSAT20T00000003,
        and
        70RSAT20T00000033.
        The content of this specification does not
        necessarily reflect the position or the policy of the U.S. Government
        and no official endorsement should be inferred.
      </p>
    </section>
  

<section id="references" class="appendix"><div class="header-wrapper"><h2 id="c-references"><bdi class="secno">C. </bdi>References</h2><a class="self-link" href="#references" aria-label="Permalink for Appendix C."></a></div><section id="normative-references"><div class="header-wrapper"><h3 id="c-1-normative-references"><bdi class="secno">C.1 </bdi>Normative references</h3><a class="self-link" href="#normative-references" aria-label="Permalink for Appendix C.1"></a></div>
    
    <dl class="bibliography"><dt id="bib-bbs">[BBS]</dt><dd>
      <a href="https://mattrglobal.github.io/bbs-signatures-spec/"><cite>BBS+ Signatures</cite></a>. Michael Lodder; Tobias Looker. Draft. URL: <a href="https://mattrglobal.github.io/bbs-signatures-spec/">https://mattrglobal.github.io/bbs-signatures-spec/</a>
    </dd><dt id="bib-blake2">[BLAKE2]</dt><dd>
      <a href="https://www.blake2.net/"><cite>Blake2 - fast secure hashing</cite></a>. URL: <a href="https://www.blake2.net/">https://www.blake2.net/</a>
    </dd><dt id="bib-cfrg-bbs-signature">[CFRG-BBS-SIGNATURE]</dt><dd>
      <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html"><cite>The BBS Signature Scheme</cite></a>. Tobias Looker; Vasilis Kalos; Andrew Whitehead; Mike Lodder. Draft. URL: <a href="https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html">https://www.ietf.org/archive/id/draft-irtf-cfrg-bbs-signatures-02.html</a>
    </dd><dt id="bib-data-integrity">[DATA-INTEGRITY]</dt><dd>
      <a href="https://w3c-ccg.github.io/data-integrity-spec/"><cite>Data Integrity 1.0</cite></a>. David Longley; Manu Sporny.  Credentials Community Group. CGDRAFT. URL: <a href="https://w3c-ccg.github.io/data-integrity-spec/">https://w3c-ccg.github.io/data-integrity-spec/</a>
    </dd><dt id="bib-did-core">[DID-CORE]</dt><dd>
      <a href="https://www.w3.org/TR/did-core/"><cite>Decentralized Identifiers (DIDs) v1.0</cite></a>. Manu Sporny; Amy Guy; Markus Sabadello; Drummond Reed.  W3C. 19 July 2022. W3C Recommendation. URL: <a href="https://www.w3.org/TR/did-core/">https://www.w3.org/TR/did-core/</a>
    </dd><dt id="bib-iso8601">[ISO8601]</dt><dd>
      <a href="http://www.iso.org/iso/catalogue_detail?csnumber=40874"><cite>Representation of dates and times. ISO 8601:2004.</cite></a>.  International Organization for Standardization (ISO). 2004. ISO 8601:2004. URL: <a href="http://www.iso.org/iso/catalogue_detail?csnumber=40874">http://www.iso.org/iso/catalogue_detail?csnumber=40874</a>
    </dd><dt id="bib-json-ld">[JSON-LD]</dt><dd>
      <a href="https://www.w3.org/TR/json-ld11"><cite>JSON-LD 1.1</cite></a>. Dave Longley; Gregg Kellogg; Pierre-Antoine Champin.  W3C. Candidate Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11">https://www.w3.org/TR/json-ld11</a>
    </dd><dt id="bib-json-ld-framing">[JSON-LD-FRAMING]</dt><dd>
      <a href="https://www.w3.org/TR/json-ld11-framing"><cite>JSON-LD 1.1 Framing</cite></a>. Dave Longley; Gregg Kellogg; Pierre-Antoine Champin.  W3C. Candidate Recommendation. URL: <a href="https://www.w3.org/TR/json-ld11-framing">https://www.w3.org/TR/json-ld11-framing</a>
    </dd><dt id="bib-multibase">[MULTIBASE]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-multiformats-multibase-01"><cite>Multibase</cite></a>. URL: <a href="https://tools.ietf.org/html/draft-multiformats-multibase-01">https://tools.ietf.org/html/draft-multiformats-multibase-01</a>
    </dd><dt id="bib-multicodec">[MULTICODEC]</dt><dd>
      <a href="https://github.com/multiformats/multicodec/"><cite>Multicodec</cite></a>. URL: <a href="https://github.com/multiformats/multicodec/">https://github.com/multiformats/multicodec/</a>
    </dd><dt id="bib-pairing-friendly-curves">[PAIRING-FRIENDLY-CURVES]</dt><dd>
      <a href="https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-03"><cite>Pairing-Friendly Curves</cite></a>. Yumi Sakemi; Tetsutaro Kobayashi; Tsunekazu Saito.  IETF. Internet Draft. URL: <a href="https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-03">https://tools.ietf.org/html/draft-irtf-cfrg-pairing-friendly-curves-03</a>
    </dd><dt id="bib-rdf-canon">[RDF-CANON]</dt><dd>
      <a href="https://www.w3.org/TR/rdf-canon/"><cite>RDF Dataset Canonicalization</cite></a>. Dave Longley; Gregg Kellogg; Dan Yamamoto.  W3C. 10 April 2023. W3C Working Draft. URL: <a href="https://www.w3.org/TR/rdf-canon/">https://www.w3.org/TR/rdf-canon/</a>
    </dd><dt id="bib-rdf-concepts">[RDF-CONCEPTS]</dt><dd>
      <a href="https://www.w3.org/TR/rdf11-concepts/"><cite>RDF 1.1 Concepts and Abstract Syntax</cite></a>. Richard Cyganiak; David Wood; Markus Lanthaler.  W3C. Recommendation. URL: <a href="https://www.w3.org/TR/rdf11-concepts/">https://www.w3.org/TR/rdf11-concepts/</a>
    </dd><dt id="bib-rdf-dataset-normalization">[RDF-DATASET-NORMALIZATION]</dt><dd>
      <a href="http://json-ld.github.io/normalization/spec/"><cite>RDF Dataset Normalization 1.0</cite></a>. David Longley; Manu Sporny.  JSON-LD Community Group. CGDRAFT. URL: <a href="http://json-ld.github.io/normalization/spec/">http://json-ld.github.io/normalization/spec/</a>
    </dd><dt id="bib-rdf-n-quads">[RDF-N-Quads]</dt><dd>
      <a href="http://json-ld.github.io/normalization/spec/"><cite>RDF 1.1 N-Quads</cite></a>. Gaven Carothers. Recommendation. URL: <a href="http://json-ld.github.io/normalization/spec/">http://json-ld.github.io/normalization/spec/</a>
    </dd><dt id="bib-rfc2119">[RFC2119]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc2119"><cite>Key words for use in RFCs to Indicate Requirement Levels</cite></a>. S. Bradner.  IETF. March 1997. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc2119">https://www.rfc-editor.org/rfc/rfc2119</a>
    </dd><dt id="bib-rfc3986">[RFC3986]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc3986"><cite>Uniform Resource Identifier (URI): Generic Syntax</cite></a>. T. Berners-Lee; R. Fielding; L. Masinter.  IETF. January 2005. Internet Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc3986">https://www.rfc-editor.org/rfc/rfc3986</a>
    </dd><dt id="bib-rfc7517">[RFC7517]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc7517"><cite>JSON Web Key (JWK)</cite></a>. M. Jones.  IETF. May 2015. Proposed Standard. URL: <a href="https://www.rfc-editor.org/rfc/rfc7517">https://www.rfc-editor.org/rfc/rfc7517</a>
    </dd><dt id="bib-rfc8174">[RFC8174]</dt><dd>
      <a href="https://www.rfc-editor.org/rfc/rfc8174"><cite>Ambiguity of Uppercase vs Lowercase in RFC 2119 Key Words</cite></a>. B. Leiba.  IETF. May 2017. Best Current Practice. URL: <a href="https://www.rfc-editor.org/rfc/rfc8174">https://www.rfc-editor.org/rfc/rfc8174</a>
    </dd><dt id="bib-vc-data-integrity">[VC-DATA-INTEGRITY]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-integrity/"><cite>Verifiable Credential Data Integrity 1.0</cite></a>. Manu Sporny; Dave Longley; Michael Prorock.  W3C. 8 April 2023. W3C Working Draft. URL: <a href="https://www.w3.org/TR/vc-data-integrity/">https://www.w3.org/TR/vc-data-integrity/</a>
    </dd><dt id="bib-xmlschema11-2">[XMLSCHEMA11-2]</dt><dd>
      <a href="https://www.w3.org/TR/xmlschema11-2/"><cite>W3C XML Schema Definition Language (XSD) 1.1 Part 2: Datatypes</cite></a>. David Peterson; Sandy Gao; Ashok Malhotra; Michael Sperberg-McQueen; Henry Thompson; Paul V. Biron et al.  W3C. 5 April 2012. W3C Recommendation. URL: <a href="https://www.w3.org/TR/xmlschema11-2/">https://www.w3.org/TR/xmlschema11-2/</a>
    </dd></dl>
  </section><section id="informative-references"><div class="header-wrapper"><h3 id="c-2-informative-references"><bdi class="secno">C.2 </bdi>Informative references</h3><a class="self-link" href="#informative-references" aria-label="Permalink for Appendix C.2"></a></div>
    
    <dl class="bibliography"><dt id="bib-vc-data-model-2">[VC-DATA-MODEL-2]</dt><dd>
      <a href="https://www.w3.org/TR/vc-data-model-2.0/"><cite>Verifiable Credentials Data Model v2.0</cite></a>. Manu Sporny; Dave Longley; Grant Noble; Dan Burnett; Ted Thibodeau; Brent Zundel; David Chadwick; Kyle Den Hartog.  W3C Verifiable Credentials Working Group. Working Draft. URL: <a href="https://www.w3.org/TR/vc-data-model-2.0/">https://www.w3.org/TR/vc-data-model-2.0/</a>
    </dd></dl>
  </section></section><p role="navigation" id="back-to-top">
    <a href="#title"><abbr title="Back to Top">↑</abbr></a>
  </p><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data-integrity-proof" aria-label="Links in this document to definition: data integrity proof">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-data-integrity-proof" aria-label="Permalink for definition: data integrity proof. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
     <a href="#ref-for-dfn-data-integrity-proof-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-integrity-proof-3" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-4" title="§ 2. Data Model">§ 2. Data Model</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-5" title="§ 2.1 Verification Methods">§ 2.1 Verification Methods</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-6" title="§ A.2.2.1 Proof Type">§ A.2.2.1 Proof Type</a> <a href="#ref-for-dfn-data-integrity-proof-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-integrity-proof-8" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-9" title="§ A.2.2.2 Created">§ A.2.2.2 Created</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-10" title="§ A.2.2.4 Verification Method">§ A.2.2.4 Verification Method</a> <a href="#ref-for-dfn-data-integrity-proof-11" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-integrity-proof-12" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-13" title="§ A.2.2.5 Proof Purpose">§ A.2.2.5 Proof Purpose</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-14" title="§ A.2.2.6 Required Reveal Statements">§ A.2.2.6 Required Reveal Statements</a> <a href="#ref-for-dfn-data-integrity-proof-15" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-16" title="§ A.2.2.7 Proof Value">§ A.2.2.7 Proof Value</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-17" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> <a href="#ref-for-dfn-data-integrity-proof-18" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-19" title="§ A.3.1.1 Proof Type">§ A.3.1.1 Proof Type</a> <a href="#ref-for-dfn-data-integrity-proof-20" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-integrity-proof-21" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-22" title="§ A.3.1.2 Created">§ A.3.1.2 Created</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-23" title="§ A.3.1.3 Verification Method">§ A.3.1.3 Verification Method</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-24" title="§ A.3.1.4 Proof Purpose">§ A.3.1.4 Proof Purpose</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-25" title="§ A.3.1.5 Proof Value">§ A.3.1.5 Proof Value</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-26" title="§ A.3.1.6 Nonce">§ A.3.1.6 Nonce</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-27" title="§ A.4.2.1 Proof Type">§ A.4.2.1 Proof Type</a> <a href="#ref-for-dfn-data-integrity-proof-28" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-integrity-proof-29" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-30" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> <a href="#ref-for-dfn-data-integrity-proof-31" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-32" title="§ A.5.1.1 Proof Type">§ A.5.1.1 Proof Type</a> <a href="#ref-for-dfn-data-integrity-proof-33" title="Reference 2">(2)</a> <a href="#ref-for-dfn-data-integrity-proof-34" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-35" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-private-key" aria-label="Links in this document to definition: private key">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-private-key" aria-label="Permalink for definition: private key. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
     
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-challenge" aria-label="Links in this document to definition: challenge">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-challenge" aria-label="Permalink for definition: challenge. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
     
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-domain" aria-label="Links in this document to definition: domain">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-domain" aria-label="Permalink for definition: domain. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
     <a href="#ref-for-dfn-domain-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-domain-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-cryptosuite" aria-label="Links in this document to definition: cryptographic suite">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-cryptosuite" aria-label="Permalink for definition: cryptographic suite. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
     
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-decentralized-identifiers" aria-label="Links in this document to definition: decentralized identifier">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-decentralized-identifiers" aria-label="Permalink for definition: decentralized identifier. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
     
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controller-s" aria-label="Links in this document to definition: controller">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controller-s" aria-label="Permalink for definition: controller. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
     <a href="#ref-for-dfn-controller-s-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-controller-documents" aria-label="Links in this document to definition: controller document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-controller-documents" aria-label="Permalink for definition: controller document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-controller-documents-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> <a href="#ref-for-dfn-controller-documents-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-subjects" aria-label="Links in this document to definition: subject">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-subjects" aria-label="Permalink for definition: subject. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
      
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-distributed-ledger-technology" aria-label="Links in this document to definition: distributed ledger">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-distributed-ledger-technology" aria-label="Permalink for definition: distributed ledger. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-distributed-ledger-technology-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-verification-method" aria-label="Links in this document to definition: verification method">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-verification-method" aria-label="Permalink for definition: verification method. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-verification-method-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a>  
  </li><li>
    <a href="#ref-for-dfn-verification-method-3" title="§ 2. Data Model">§ 2. Data Model</a> 
  </li><li>
    <a href="#ref-for-dfn-verification-method-4" title="§ 2.1 Verification Methods">§ 2.1 Verification Methods</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-signature-suite" aria-label="Links in this document to definition: signature suite">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-signature-suite" aria-label="Permalink for definition: signature suite. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-signature-suite-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-2" title="§ A.2 The BBS+ Signature Suite 2020">§ A.2 The BBS+ Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-3" title="§ A.2.2.3 @context">§ A.2.2.3 @context</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-4" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-5" title="§ A.3.1 Terms">§ A.3.1 Terms</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-6" title="§ A.4 The BBS+ Bound Signature Suite 2020">§ A.4 The BBS+ Bound Signature Suite 2020</a> <a href="#ref-for-dfn-signature-suite-7" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-8" title="§ A.4.1.1 Create Verify Data Algorithm">§ A.4.1.1 Create Verify Data Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-9" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> <a href="#ref-for-dfn-signature-suite-10" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-suite-11" title="§ A.5.1 Terms">§ A.5.1 Terms</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canonicalization-algorithm" aria-label="Links in this document to definition: canonicalization algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-canonicalization-algorithm" aria-label="Permalink for definition: canonicalization algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-canonicalization-algorithm-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> <a href="#ref-for-dfn-canonicalization-algorithm-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-3" title="§ A.2 The BBS+ Signature Suite 2020">§ A.2 The BBS+ Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-4" title="§ A.2.1.1 Create Verify Data Algorithm">§ A.2.1.1 Create Verify Data Algorithm</a> <a href="#ref-for-dfn-canonicalization-algorithm-5" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-6" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-7" title="§ A.4 The BBS+ Bound Signature Suite 2020">§ A.4 The BBS+ Bound Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-8" title="§ A.4.1.1 Create Verify Data Algorithm">§ A.4.1.1 Create Verify Data Algorithm</a> <a href="#ref-for-dfn-canonicalization-algorithm-9" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-10" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-canonicalization-algorithm-11" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-canonicalization-algorithm-12" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-canonical-form" aria-label="Links in this document to definition: canonical form">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-canonical-form" aria-label="Permalink for definition: canonical form. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-canonical-form-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-canonical-form-2" title="§ A.2.2.6 Required Reveal Statements">§ A.2.2.6 Required Reveal Statements</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-statement" aria-label="Links in this document to definition: statement">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-statement" aria-label="Permalink for definition: statement. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-statement-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> <a href="#ref-for-dfn-statement-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-statement-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-statement-4" title="Reference 4">(4)</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-5" title="§ A.2.1.1 Create Verify Data Algorithm">§ A.2.1.1 Create Verify Data Algorithm</a> <a href="#ref-for-dfn-statement-6" title="Reference 2">(2)</a> <a href="#ref-for-dfn-statement-7" title="Reference 3">(3)</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-8" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-9" title="§ A.4.1.1 Create Verify Data Algorithm">§ A.4.1.1 Create Verify Data Algorithm</a> <a href="#ref-for-dfn-statement-10" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-11" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-12" title="§ A.6 Derive Proof Algorithm">§ A.6 Derive Proof Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-13" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-statement-14" title="Reference 2">(2)</a> <a href="#ref-for-dfn-statement-15" title="Reference 3">(3)</a> <a href="#ref-for-dfn-statement-16" title="Reference 4">(4)</a> <a href="#ref-for-dfn-statement-17" title="Reference 5">(5)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-statement-digest-algorithm" aria-label="Links in this document to definition: statement digest algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-statement-digest-algorithm" aria-label="Permalink for definition: statement digest algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-statement-digest-algorithm-1" title="§ 1. Introduction">§ 1. Introduction</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-algorithm-2" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-algorithm-3" title="§ A.2 The BBS+ Signature Suite 2020">§ A.2 The BBS+ Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-algorithm-4" title="§ A.2.1.1 Create Verify Data Algorithm">§ A.2.1.1 Create Verify Data Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-algorithm-5" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-algorithm-6" title="§ A.4 The BBS+ Bound Signature Suite 2020">§ A.4 The BBS+ Bound Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-algorithm-7" title="§ A.4.1.1 Create Verify Data Algorithm">§ A.4.1.1 Create Verify Data Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-algorithm-8" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-statement-digest" aria-label="Links in this document to definition: statement digest">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-statement-digest" aria-label="Permalink for definition: statement digest. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-statement-digest-1" title="§ A.2.1.1 Create Verify Data Algorithm">§ A.2.1.1 Create Verify Data Algorithm</a> <a href="#ref-for-dfn-statement-digest-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-statement-digest-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-statement-digest-4" title="Reference 4">(4)</a> <a href="#ref-for-dfn-statement-digest-5" title="Reference 5">(5)</a> 
  </li><li>
    <a href="#ref-for-dfn-statement-digest-6" title="§ A.4.1.1 Create Verify Data Algorithm">§ A.4.1.1 Create Verify Data Algorithm</a> <a href="#ref-for-dfn-statement-digest-7" title="Reference 2">(2)</a> <a href="#ref-for-dfn-statement-digest-8" title="Reference 3">(3)</a> <a href="#ref-for-dfn-statement-digest-9" title="Reference 4">(4)</a> <a href="#ref-for-dfn-statement-digest-10" title="Reference 5">(5)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-signature-algorithm" aria-label="Links in this document to definition: signature algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-signature-algorithm" aria-label="Permalink for definition: signature algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-signature-algorithm-1" title="§ 1. Introduction">§ 1. Introduction</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-algorithm-2" title="§ A.2 The BBS+ Signature Suite 2020">§ A.2 The BBS+ Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-algorithm-3" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-algorithm-4" title="§ A.4 The BBS+ Bound Signature Suite 2020">§ A.4 The BBS+ Bound Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-signature-algorithm-5" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-selective-disclosure" aria-label="Links in this document to definition: selective disclosure">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-selective-disclosure" aria-label="Permalink for definition: selective disclosure. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-selective-disclosure-1" title="§ A.2.1.1 Create Verify Data Algorithm">§ A.2.1.1 Create Verify Data Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-selective-disclosure-2" title="§ A.2.2.6 Required Reveal Statements">§ A.2.2.6 Required Reveal Statements</a> 
  </li><li>
    <a href="#ref-for-dfn-selective-disclosure-3" title="§ A.6 Derive Proof Algorithm">§ A.6 Derive Proof Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-data-integrity-proof-document" aria-label="Links in this document to definition: data integrity proof document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-data-integrity-proof-document" aria-label="Permalink for definition: data integrity proof document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-data-integrity-proof-document-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> <a href="#ref-for-dfn-data-integrity-proof-document-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-data-integrity-proof-document-3" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-data-integrity-proof-document-4" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-revealed-statements" aria-label="Links in this document to definition: revealed statements">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-revealed-statements" aria-label="Permalink for definition: revealed statements. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-revealed-statements-1" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-revealed-statements-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-derive-proof-algorithm" aria-label="Links in this document to definition: derive proof algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-derive-proof-algorithm" aria-label="Permalink for definition: derive proof algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-derive-proof-algorithm-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> <a href="#ref-for-dfn-derive-proof-algorithm-2" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-derive-proof-algorithm-3" title="§ A.6 Derive Proof Algorithm">§ A.6 Derive Proof Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-derive-proof-algorithm-4" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-derive-proof-algorithm-5" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-derived-proof" aria-label="Links in this document to definition: derived proof">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-derived-proof" aria-label="Permalink for definition: derived proof. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-derived-proof-1" title="§ A.2.2.6 Required Reveal Statements">§ A.2.2.6 Required Reveal Statements</a> <a href="#ref-for-dfn-derived-proof-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-quad" aria-label="Links in this document to definition: quad">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-quad" aria-label="Permalink for definition: quad. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-quad-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-n-quad" aria-label="Links in this document to definition: n-quad">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-n-quad" aria-label="Permalink for definition: n-quad. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-n-quad-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-n-quad-2" title="§ A.2.1.1 Create Verify Data Algorithm">§ A.2.1.1 Create Verify Data Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-n-quad-3" title="§ A.4.1.1 Create Verify Data Algorithm">§ A.4.1.1 Create Verify Data Algorithm</a> 
  </li><li>
    <a href="#ref-for-dfn-n-quad-4" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-n-quad-5" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-linked-data-document" aria-label="Links in this document to definition: linked data document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-linked-data-document" aria-label="Permalink for definition: linked data document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-linked-data-document-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-2" title="§ A.2.2.1 Proof Type">§ A.2.2.1 Proof Type</a> <a href="#ref-for-dfn-linked-data-document-3" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-4" title="§ A.2.2.2 Created">§ A.2.2.2 Created</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-5" title="§ A.2.2.4 Verification Method">§ A.2.2.4 Verification Method</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-6" title="§ A.2.2.5 Proof Purpose">§ A.2.2.5 Proof Purpose</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-7" title="§ A.2.2.6 Required Reveal Statements">§ A.2.2.6 Required Reveal Statements</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-8" title="§ A.2.2.7 Proof Value">§ A.2.2.7 Proof Value</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-9" title="§ A.3.1.1 Proof Type">§ A.3.1.1 Proof Type</a> <a href="#ref-for-dfn-linked-data-document-10" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-11" title="§ A.3.1.2 Created">§ A.3.1.2 Created</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-12" title="§ A.3.1.3 Verification Method">§ A.3.1.3 Verification Method</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-13" title="§ A.3.1.4 Proof Purpose">§ A.3.1.4 Proof Purpose</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-14" title="§ A.3.1.5 Proof Value">§ A.3.1.5 Proof Value</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-15" title="§ A.3.1.6 Nonce">§ A.3.1.6 Nonce</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-16" title="§ A.4.2.1 Proof Type">§ A.4.2.1 Proof Type</a> <a href="#ref-for-dfn-linked-data-document-17" title="Reference 2">(2)</a> 
  </li><li>
    <a href="#ref-for-dfn-linked-data-document-18" title="§ A.5.1.1 Proof Type">§ A.5.1.1 Proof Type</a> <a href="#ref-for-dfn-linked-data-document-19" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-curve-name" aria-label="Links in this document to definition: curve name">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-curve-name" aria-label="Permalink for definition: curve name. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-curve-name-1" title="§ A.2 The BBS+ Signature Suite 2020">§ A.2 The BBS+ Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-curve-name-2" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-curve-name-3" title="§ A.4 The BBS+ Bound Signature Suite 2020">§ A.4 The BBS+ Bound Signature Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-curve-name-4" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-frame" aria-label="Links in this document to definition: frame">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-frame" aria-label="Permalink for definition: frame. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-frame-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-frame-2" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-json-ld-document" aria-label="Links in this document to definition: JSON-LD document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-json-ld-document" aria-label="Permalink for definition: JSON-LD document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-json-ld-document-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> 
  </li><li>
    <a href="#ref-for-dfn-json-ld-document-2" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-framing-algorithm" aria-label="Links in this document to definition: framing algorithm">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-framing-algorithm" aria-label="Permalink for definition: framing algorithm. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-framing-algorithm-1" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-framing-algorithm-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-framing-algorithm-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-bls12381g1key2020" aria-label="Links in this document to definition: Bls12381G1Key2020">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-bls12381g1key2020" aria-label="Permalink for definition: Bls12381G1Key2020. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-bls12381g1key2020-1" title="§ A.1.1 Bls 12-381 G1 Public Key">§ A.1.1 Bls 12-381 G1 Public Key</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-bls12381g2key2020" aria-label="Links in this document to definition: Bls12381G2Key2020">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-bls12381g2key2020" aria-label="Permalink for definition: Bls12381G2Key2020. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-bls12381g2key2020-1" title="§ A.1.2 Bls 12-381 G2 Public Key">§ A.1.2 Bls 12-381 G2 Public Key</a> 
  </li><li>
    <a href="#ref-for-dfn-bls12381g2key2020-2" title="§ A.2.2.4 Verification Method">§ A.2.2.4 Verification Method</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-bbsblssignature2020" aria-label="Links in this document to definition: BbsBlsSignature2020">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-bbsblssignature2020" aria-label="Permalink for definition: BbsBlsSignature2020. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-bbsblssignature2020-1" title="§ A.3 The BBS+ Signature Proof Suite 2020">§ A.3 The BBS+ Signature Proof Suite 2020</a> 
  </li><li>
    <a href="#ref-for-dfn-bbsblssignature2020-2" title="§ A.3.1.3 Verification Method">§ A.3.1.3 Verification Method</a> 
  </li><li>
    <a href="#ref-for-dfn-bbsblssignature2020-3" title="§ A.3.1.4 Proof Purpose">§ A.3.1.4 Proof Purpose</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-bbsblsboundsignature2020" aria-label="Links in this document to definition: BbsBlsBoundSignature2020">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-bbsblsboundsignature2020" aria-label="Permalink for definition: BbsBlsBoundSignature2020. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-bbsblsboundsignature2020-1" title="§ A.5 The BBS+ Bound Signature Proof Suite 2020">§ A.5 The BBS+ Bound Signature Proof Suite 2020</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-input-proof-document" aria-label="Links in this document to definition: input proof document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-input-proof-document" aria-label="Permalink for definition: input proof document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-input-proof-document-1" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-input-proof-document-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-input-proof-document-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-reveal-document" aria-label="Links in this document to definition: reveal document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-reveal-document" aria-label="Permalink for definition: reveal document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-reveal-document-1" title="§ 1.1 Terminology">§ 1.1 Terminology</a> <a href="#ref-for-dfn-reveal-document-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-reveal-document-3" title="Reference 3">(3)</a> <a href="#ref-for-dfn-reveal-document-4" title="Reference 4">(4)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-revealed-document" aria-label="Links in this document to definition: revealed document">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-revealed-document" aria-label="Permalink for definition: revealed document. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-revealed-document-1" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-revealed-document-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-input-proof-document-statements" aria-label="Links in this document to definition: input proof document statements">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-input-proof-document-statements" aria-label="Permalink for definition: input proof document statements. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-input-proof-document-statements-1" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-input-proof-document-statements-2" title="Reference 2">(2)</a> <a href="#ref-for-dfn-input-proof-document-statements-3" title="Reference 3">(3)</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-total-statements" aria-label="Links in this document to definition: total statements">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-total-statements" aria-label="Permalink for definition: total statements. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-total-statements-1" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> 
  </li>
  </ul>
    </div><div class="dfn-panel" hidden="" role="dialog" aria-modal="true" id="dfn-panel-for-dfn-revealed-indicies" aria-label="Links in this document to definition: revealed indicies">
      <span class="caret"></span>
      <div>
        <a class="self-link" href="#dfn-revealed-indicies" aria-label="Permalink for definition: revealed indicies. Activate to close this dialog.">Permalink</a>
         
      </div>
      <p><b>Referenced in:</b></p>
      <ul>
    <li>
    <a href="#ref-for-dfn-revealed-indicies-1" title="§ A.6.1 Create Derive Proof Data Algorithm">§ A.6.1 Create Derive Proof Data Algorithm</a> <a href="#ref-for-dfn-revealed-indicies-2" title="Reference 2">(2)</a> 
  </li>
  </ul>
    </div><script id="respec-dfn-panel">(() => {
// @ts-check
if (document.respec) {
  document.respec.ready.then(setupPanel);
} else {
  setupPanel();
}

function setupPanel() {
  const listener = panelListener();
  document.body.addEventListener("keydown", listener);
  document.body.addEventListener("click", listener);
}

function panelListener() {
  /** @type {HTMLElement} */
  let panel = null;
  return event => {
    const { target, type } = event;

    if (!(target instanceof HTMLElement)) return;

    // For keys, we only care about Enter key to activate the panel
    // otherwise it's activated via a click.
    if (type === "keydown" && event.key !== "Enter") return;

    const action = deriveAction(event);

    switch (action) {
      case "show": {
        hidePanel(panel);
        /** @type {HTMLElement} */
        const dfn = target.closest("dfn, .index-term");
        panel = document.getElementById(`dfn-panel-for-${dfn.id}`);
        const coords = deriveCoordinates(event);
        displayPanel(dfn, panel, coords);
        break;
      }
      case "dock": {
        panel.style.left = null;
        panel.style.top = null;
        panel.classList.add("docked");
        break;
      }
      case "hide": {
        hidePanel(panel);
        panel = null;
        break;
      }
    }
  };
}

/**
 * @param {MouseEvent|KeyboardEvent} event
 */
function deriveCoordinates(event) {
  const target = /** @type HTMLElement */ (event.target);

  // We prevent synthetic AT clicks from putting
  // the dialog in a weird place. The AT events sometimes
  // lack coordinates, so they have clientX/Y = 0
  const rect = target.getBoundingClientRect();
  if (
    event instanceof MouseEvent &&
    event.clientX >= rect.left &&
    event.clientY >= rect.top
  ) {
    // The event probably happened inside the bounding rect...
    return { x: event.clientX, y: event.clientY };
  }

  // Offset to the middle of the element
  const x = rect.x + rect.width / 2;
  // Placed at the bottom of the element
  const y = rect.y + rect.height;
  return { x, y };
}

/**
 * @param {Event} event
 */
function deriveAction(event) {
  const target = /** @type {HTMLElement} */ (event.target);
  const hitALink = !!target.closest("a");
  if (target.closest("dfn:not([data-cite]), .index-term")) {
    return hitALink ? "none" : "show";
  }
  if (target.closest(".dfn-panel")) {
    if (hitALink) {
      return target.classList.contains("self-link") ? "hide" : "dock";
    }
    const panel = target.closest(".dfn-panel");
    return panel.classList.contains("docked") ? "hide" : "none";
  }
  if (document.querySelector(".dfn-panel:not([hidden])")) {
    return "hide";
  }
  return "none";
}

/**
 * @param {HTMLElement} dfn
 * @param {HTMLElement} panel
 * @param {{ x: number, y: number }} clickPosition
 */
function displayPanel(dfn, panel, { x, y }) {
  panel.hidden = false;
  // distance (px) between edge of panel and the pointing triangle (caret)
  const MARGIN = 20;

  const dfnRects = dfn.getClientRects();
  // Find the `top` offset when the `dfn` can be spread across multiple lines
  let closestTop = 0;
  let minDiff = Infinity;
  for (const rect of dfnRects) {
    const { top, bottom } = rect;
    const diffFromClickY = Math.abs((top + bottom) / 2 - y);
    if (diffFromClickY < minDiff) {
      minDiff = diffFromClickY;
      closestTop = top;
    }
  }

  const top = window.scrollY + closestTop + dfnRects[0].height;
  const left = x - MARGIN;
  panel.style.left = `${left}px`;
  panel.style.top = `${top}px`;

  // Find if the panel is flowing out of the window
  const panelRect = panel.getBoundingClientRect();
  const SCREEN_WIDTH = Math.min(window.innerWidth, window.screen.width);
  if (panelRect.right > SCREEN_WIDTH) {
    const newLeft = Math.max(MARGIN, x + MARGIN - panelRect.width);
    const newCaretOffset = left - newLeft;
    panel.style.left = `${newLeft}px`;
    /** @type {HTMLElement} */
    const caret = panel.querySelector(".caret");
    caret.style.left = `${newCaretOffset}px`;
  }

  // As it's a dialog, we trap focus.
  // TODO: when <dialog> becomes a implemented, we should really
  // use that.
  trapFocus(panel, dfn);
}

/**
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function trapFocus(panel, dfn) {
  /** @type NodeListOf<HTMLAnchorElement> elements */
  const anchors = panel.querySelectorAll("a[href]");
  // No need to trap focus
  if (!anchors.length) return;

  // Move focus to first anchor element
  const first = anchors.item(0);
  first.focus();

  const trapListener = createTrapListener(anchors, panel, dfn);
  panel.addEventListener("keydown", trapListener);

  // Hiding the panel releases the trap
  const mo = new MutationObserver(records => {
    const [record] = records;
    const target = /** @type HTMLElement */ (record.target);
    if (target.hidden) {
      panel.removeEventListener("keydown", trapListener);
      mo.disconnect();
    }
  });
  mo.observe(panel, { attributes: true, attributeFilter: ["hidden"] });
}

/**
 *
 * @param {NodeListOf<HTMLAnchorElement>} anchors
 * @param {HTMLElement} panel
 * @param {HTMLElement} dfn
 * @returns
 */
function createTrapListener(anchors, panel, dfn) {
  const lastIndex = anchors.length - 1;
  let currentIndex = 0;
  return event => {
    switch (event.key) {
      // Hitting "Tab" traps us in a nice loop around elements.
      case "Tab": {
        event.preventDefault();
        currentIndex += event.shiftKey ? -1 : +1;
        if (currentIndex < 0) {
          currentIndex = lastIndex;
        } else if (currentIndex > lastIndex) {
          currentIndex = 0;
        }
        anchors.item(currentIndex).focus();
        break;
      }

      // Hitting "Enter" on an anchor releases the trap.
      case "Enter":
        hidePanel(panel);
        break;

      // Hitting "Escape" returns focus to dfn.
      case "Escape":
        hidePanel(panel);
        dfn.focus();
        return;
    }
  };
}

/** @param {HTMLElement} panel */
function hidePanel(panel) {
  if (!panel) return;
  panel.hidden = true;
  panel.classList.remove("docked");
}
})()</script><script src="https://www.w3.org/scripts/TR/2021/fixup.js"></script></body></html>